<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Hamiltonian Diagonalization: diagonalization::NonInteractingOflModelGrid Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Hamiltonian Diagonalization
   &#160;<span id="projectnumber">Version 1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classdiagonalization_1_1NonInteractingOflModelGrid.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="classdiagonalization_1_1NonInteractingOflModelGrid-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">diagonalization::NonInteractingOflModelGrid Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The <a class="el" href="classdiagonalization_1_1NonInteractingOflModelGrid.html" title="The NonInteractingOflModelGrid class contains functions that act on arrays of NoninteractingOflModel ...">NonInteractingOflModelGrid</a> class contains functions that act on arrays of NoninteractingOflModel objects. No data is contained in the class itself, and default constructors/destructors are always used. Writing the functions in this way allows us to group them together in a friend class of the NoninteractingOflModel class.  
 <a href="classdiagonalization_1_1NonInteractingOflModelGrid.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="noninteracting__ofl__model__grid_8hpp_source.html">noninteracting_ofl_model_grid.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae77a9b7b45a0a19409a94e74a683daf1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdiagonalization_1_1NonInteractingOflModelGrid.html#ae77a9b7b45a0a19409a94e74a683daf1">CalculateBandstructure</a> (double *lowerBand, double *secondBand, double &amp;bandWidth, double &amp;bandGap, const bool getEnergyData, double *magnetization, const bool getMagnetizationData, const <a class="el" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> dimX, const <a class="el" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> dimY, const double offsetX, const double offsetY, <a class="el" href="classdiagonalization_1_1NonInteractingOflModel.html">NonInteractingOflModel</a> *ham, <a class="el" href="structutilities_1_1MpiWrapper.html">utilities::MpiWrapper</a> &amp;<a class="el" href="fqhe__sphere__spinless__fermions__diagonalization_8cpp.html#a1a7112d51c59f426cab52975031ff6e7">mpi</a>)</td></tr>
<tr class="separator:ae77a9b7b45a0a19409a94e74a683daf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9166df586298af9fd39d960ce3fc89f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdiagonalization_1_1NonInteractingOflModelGrid.html#a9166df586298af9fd39d960ce3fc89f5">PlotBandstructure</a> (boost::program_options::variables_map *optionList, <a class="el" href="structutilities_1_1MpiWrapper.html">utilities::MpiWrapper</a> &amp;<a class="el" href="fqhe__sphere__spinless__fermions__diagonalization_8cpp.html#a1a7112d51c59f426cab52975031ff6e7">mpi</a>)</td></tr>
<tr class="memdesc:a9166df586298af9fd39d960ce3fc89f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plots the single particle band structure of the Hamiltonian given in e.g. eq (1) of PRL 109,265301 for a given sample of k-space.  <a href="#a9166df586298af9fd39d960ce3fc89f5">More...</a><br/></td></tr>
<tr class="separator:a9166df586298af9fd39d960ce3fc89f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58382f228c639a512e65bfbdbb3586c0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdiagonalization_1_1NonInteractingOflModelGrid.html#a58382f228c639a512e65bfbdbb3586c0">PlotBandWidth</a> (boost::program_options::variables_map *optionList, <a class="el" href="structutilities_1_1MpiWrapper.html">utilities::MpiWrapper</a> &amp;<a class="el" href="fqhe__sphere__spinless__fermions__diagonalization_8cpp.html#a1a7112d51c59f426cab52975031ff6e7">mpi</a>)</td></tr>
<tr class="separator:a58382f228c639a512e65bfbdbb3586c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c7ec6a354346ac4d5a94c14e71aab0e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdiagonalization_1_1NonInteractingOflModelGrid.html#a9c7ec6a354346ac4d5a94c14e71aab0e">PlotMagnetization</a> (boost::program_options::variables_map *optionList, <a class="el" href="structutilities_1_1MpiWrapper.html">utilities::MpiWrapper</a> &amp;<a class="el" href="fqhe__sphere__spinless__fermions__diagonalization_8cpp.html#a1a7112d51c59f426cab52975031ff6e7">mpi</a>)</td></tr>
<tr class="memdesc:a9c7ec6a354346ac4d5a94c14e71aab0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make a plot of the magnetization for a given 2D k-space grid.  <a href="#a9c7ec6a354346ac4d5a94c14e71aab0e">More...</a><br/></td></tr>
<tr class="separator:a9c7ec6a354346ac4d5a94c14e71aab0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88eed09a62247d42c450dd9f04fc8739"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdiagonalization_1_1NonInteractingOflModelGrid.html#a88eed09a62247d42c450dd9f04fc8739">CalculateSpatialWaveFunctions</a> (boost::program_options::variables_map *optionList, <a class="el" href="structutilities_1_1MpiWrapper.html">utilities::MpiWrapper</a> &amp;<a class="el" href="fqhe__sphere__spinless__fermions__diagonalization_8cpp.html#a1a7112d51c59f426cab52975031ff6e7">mpi</a>)</td></tr>
<tr class="memdesc:a88eed09a62247d42c450dd9f04fc8739"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function to generate the single-particle orbitals.  <a href="#a88eed09a62247d42c450dd9f04fc8739">More...</a><br/></td></tr>
<tr class="separator:a88eed09a62247d42c450dd9f04fc8739"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b31798ef7bf946b3bc9eeb8f6d6c726"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdiagonalization_1_1NonInteractingOflModelGrid.html#a8b31798ef7bf946b3bc9eeb8f6d6c726">GenerateBlochWaveFunctionTable</a> (const <a class="el" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> cutOff, const <a class="el" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> dimX, const <a class="el" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> dimY, const double offsetX, const double offsetY, <a class="el" href="classdiagonalization_1_1NonInteractingOflModel.html">NonInteractingOflModel</a> *blochTable, const <a class="el" href="structdiagonalization_1_1NonInteractingOflModelData.html">NonInteractingOflModelData</a> *params, <a class="el" href="structutilities_1_1MpiWrapper.html">utilities::MpiWrapper</a> &amp;<a class="el" href="fqhe__sphere__spinless__fermions__diagonalization_8cpp.html#a1a7112d51c59f426cab52975031ff6e7">mpi</a>)</td></tr>
<tr class="memdesc:a8b31798ef7bf946b3bc9eeb8f6d6c726"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a table single-particle Hamiltonian solutions for a given k-space grid covering the Brillouin zone with dimX by dimY points.  <a href="#a8b31798ef7bf946b3bc9eeb8f6d6c726">More...</a><br/></td></tr>
<tr class="separator:a8b31798ef7bf946b3bc9eeb8f6d6c726"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bcb8ebb726884935e902529edd9247d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdiagonalization_1_1NonInteractingOflModelGrid.html#a7bcb8ebb726884935e902529edd9247d">GenerateWannierCoefficients</a> (const <a class="el" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> dimX, const <a class="el" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> dimY, const double offsetX, <a class="el" href="classdiagonalization_1_1NonInteractingOflModel.html">NonInteractingOflModel</a> *blochTable, <a class="el" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a> *M, const <a class="el" href="structutilities_1_1MpiWrapper.html">utilities::MpiWrapper</a> &amp;<a class="el" href="fqhe__sphere__spinless__fermions__diagonalization_8cpp.html#a1a7112d51c59f426cab52975031ff6e7">mpi</a>)</td></tr>
<tr class="memdesc:a7bcb8ebb726884935e902529edd9247d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate the set of coefficients and phase factors required to change the single particle orbital basis to the basis of hybrid localized Wannier states as defined in Eq 32 of PRB 86,085129 (2012)  <a href="#a7bcb8ebb726884935e902529edd9247d">More...</a><br/></td></tr>
<tr class="separator:a7bcb8ebb726884935e902529edd9247d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63bd4fdcafca7506ee80a7bf470484f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdiagonalization_1_1NonInteractingOflModelGrid.html#a63bd4fdcafca7506ee80a7bf470484f8">CalcualteSigmaZMap</a> (const <a class="el" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> dimX, const <a class="el" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> dimY, <a class="el" href="classdiagonalization_1_1NonInteractingOflModel.html">NonInteractingOflModel</a> *blochTable, double *map)</td></tr>
<tr class="memdesc:a63bd4fdcafca7506ee80a7bf470484f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function to obtain a map of the sigma^z values associated with each k-space point.  <a href="#a63bd4fdcafca7506ee80a7bf470484f8">More...</a><br/></td></tr>
<tr class="separator:a63bd4fdcafca7506ee80a7bf470484f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a6b324911df2644e84609706b69cafd97"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdiagonalization_1_1NonInteractingOflModelGrid.html#a6b324911df2644e84609706b69cafd97">CombineIndexes</a> (const <a class="el" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> x, const <a class="el" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> y, const <a class="el" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> dim) const </td></tr>
<tr class="separator:a6b324911df2644e84609706b69cafd97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The <a class="el" href="classdiagonalization_1_1NonInteractingOflModelGrid.html" title="The NonInteractingOflModelGrid class contains functions that act on arrays of NoninteractingOflModel ...">NonInteractingOflModelGrid</a> class contains functions that act on arrays of NoninteractingOflModel objects. No data is contained in the class itself, and default constructors/destructors are always used. Writing the functions in this way allows us to group them together in a friend class of the NoninteractingOflModel class. </p>
<p>For instance, an array of single particle energy levels at different positions in k-space would represent a single-particle band structure </p>

<p>Definition at line <a class="el" href="noninteracting__ofl__model__grid_8hpp_source.html#l00061">61</a> of file <a class="el" href="noninteracting__ofl__model__grid_8hpp_source.html">noninteracting_ofl_model_grid.hpp</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a63bd4fdcafca7506ee80a7bf470484f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void diagonalization::NonInteractingOflModelGrid::CalcualteSigmaZMap </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a>&#160;</td>
          <td class="paramname"><em>dimX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a>&#160;</td>
          <td class="paramname"><em>dimY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdiagonalization_1_1NonInteractingOflModel.html">NonInteractingOflModel</a> *&#160;</td>
          <td class="paramname"><em>blochTable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>map</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A function to obtain a map of the sigma^z values associated with each k-space point. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dimX</td><td>X-dimension of k-space grid </td></tr>
    <tr><td class="paramname">dimY</td><td>Y-dimension of k-space grid </td></tr>
    <tr><td class="paramname">blochTable</td><td>Table of Bloch wave functions corresponding to that k-space grid </td></tr>
    <tr><td class="paramname">map</td><td>A dimX*dimY array to store the sigma^z_k values </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="noninteracting__ofl__model__grid_8cpp_source.html#l00939">939</a> of file <a class="el" href="noninteracting__ofl__model__grid_8cpp_source.html">noninteracting_ofl_model_grid.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    {</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        <span class="keywordtype">double</span>* p_map = map;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> kx=0; kx&lt;dimX; ++kx)</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        {</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> ky=0; ky&lt;dimY; ++ky, ++p_map)</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            {</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                *(p_map) = blochTable[kx*dimY+ky].ApplySigmaZ(0);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;            }</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        }</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    }</div>
<div class="ttc" id="namespacediagonalization_html_a26ca92638e21ae8791b99ae7fa90dd4c"><div class="ttname"><a href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">diagonalization::kState_t</a></div><div class="ttdeci">uint16_t kState_t</div><div class="ttdoc">Define an unsigned quantum number index type (a 16 bit unsigned int) </div><div class="ttdef"><b>Definition:</b> <a href="orbital__and__state__defs_8hpp_source.html#l00039">orbital_and_state_defs.hpp:39</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae77a9b7b45a0a19409a94e74a683daf1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void diagonalization::NonInteractingOflModelGrid::CalculateBandstructure </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>lowerBand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>secondBand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>bandWidth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>bandGap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>getEnergyData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>magnetization</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>getMagnetizationData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a>&#160;</td>
          <td class="paramname"><em>dimX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a>&#160;</td>
          <td class="paramname"><em>dimY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>offsetX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>offsetY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdiagonalization_1_1NonInteractingOflModel.html">NonInteractingOflModel</a> *&#160;</td>
          <td class="paramname"><em>currentModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structutilities_1_1MpiWrapper.html">utilities::MpiWrapper</a> &amp;&#160;</td>
          <td class="paramname"><em>mpi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Numerically calculates the non-interacting band structure of the Hamiltonian given in e.g. eq (1) of PRL 109,265301 in a single Brillouin zone </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lowerBand</td><td>List of energy eigenvalues in the lowest band (returned on node 0 only) </td></tr>
    <tr><td class="paramname">secondBand</td><td>List of energy eigenvalues in the second band (returned on node 0 only) </td></tr>
    <tr><td class="paramname">bandWidth</td><td>Return the difference between the maximum and minimum energy in the lowest band (returned on node 0 only) </td></tr>
    <tr><td class="paramname">bandGap</td><td>Return the minimum difference in energy between the lowest and second lowest band (returned on node 0 only) </td></tr>
    <tr><td class="paramname">getEnergyData</td><td>Set to true to populate the arrays in lowerBand,secondBand,bandWidth,bandGap (returned on node 0 only) </td></tr>
    <tr><td class="paramname">magnetization</td><td>Return a list of magnetization values (returned on node 0 only) </td></tr>
    <tr><td class="paramname">getMagnetizationData</td><td>Set to true to populate the magnatization array </td></tr>
    <tr><td class="paramname">dimX</td><td>Number of k-space points in G1-direction </td></tr>
    <tr><td class="paramname">dimY</td><td>Number of k-space points in G2-direction </td></tr>
    <tr><td class="paramname">offsetX</td><td>X offset in the map of k-space </td></tr>
    <tr><td class="paramname">offsetY</td><td>Y offset in the map of k-space </td></tr>
    <tr><td class="paramname">currentModel</td><td>Class containing the model data </td></tr>
    <tr><td class="paramname">mpi</td><td>Instance of the mpi wrapper class </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="noninteracting__ofl__model__grid_8cpp_source.html#l00160">160</a> of file <a class="el" href="noninteracting__ofl__model__grid_8cpp_source.html">noninteracting_ofl_model_grid.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">SecondaryOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\t- GENERATING BAND STRUCTURE FOR CURRENT MODEL PARAMETERS&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        currentModel-&gt;PopulateDifferenceMatrix();</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <a class="code" href="classutilities_1_1LatticeVector2D.html">utilities::LatticeVector2D&lt;double&gt;</a> kVector(offsetX,offsetY);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <a class="code" href="classutilities_1_1LatticeVector2D.html">utilities::LatticeVector2D&lt;double&gt;</a> increment1(<a class="code" href="namespacediagonalization_1_1reciprocalLattice.html#aa61393cdc02028a0375aa5071f06cb86">reciprocalLattice::G1</a>,(<span class="keywordtype">double</span>)1/dimX);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <a class="code" href="classutilities_1_1LatticeVector2D.html">utilities::LatticeVector2D&lt;double&gt;</a> increment2(<a class="code" href="namespacediagonalization_1_1reciprocalLattice.html#a09fc4b1306501141a270fa90bd159fe1">reciprocalLattice::G2</a>,(<span class="keywordtype">double</span>)1/dimY);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a58a92efc3951241eb3548b58bdf2c5ab">DivideTasks</a>(mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>,dimX*dimY,mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0615e4621e3e3fe7c42f6e5bc0f00d6a">m_nbrProcs</a>,&amp;mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#aafee6ab3a3b23174586b41f38da96bab">m_firstTask</a>,&amp;mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a948a6b1b3daa673cc4ebd93eb0af6770">m_lastTask</a>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> counter  = 0;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <a class="code" href="classutilities_1_1LoadBar.html">utilities::LoadBar</a> progress;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            progress.<a class="code" href="classutilities_1_1LoadBar.html#a744cf589bf2d35dfda32af5d3ba4185d">Initialize</a>(mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a948a6b1b3daa673cc4ebd93eb0af6770">m_lastTask</a> - mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#aafee6ab3a3b23174586b41f38da96bab">m_firstTask</a>+1);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> x=0; x&lt;dimX; ++x, kVector-=<a class="code" href="namespacediagonalization_1_1reciprocalLattice.html#a09fc4b1306501141a270fa90bd159fe1">reciprocalLattice::G2</a>, kVector += increment1)   <span class="comment">//  Map out G1 direction</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> y=0; y&lt;dimY; ++y, kVector += increment2, ++counter)   <span class="comment">//  Map out G2 direction</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                <span class="keywordflow">if</span>(mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#aafee6ab3a3b23174586b41f38da96bab">m_firstTask</a> &lt;= (<span class="keywordtype">int</span>)counter &amp;&amp; mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a948a6b1b3daa673cc4ebd93eb0af6770">m_lastTask</a> &gt;= (<span class="keywordtype">int</span>)counter)</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                {      </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                    currentModel-&gt;UpdateDifferenceDiagonal(kVector);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                    currentModel-&gt;DiagonalizeDifferenceMatrix();</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                    <span class="keywordflow">if</span>(getEnergyData)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                    {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                        lowerBand[x*dimY+y]  = currentModel-&gt;m_eigenvalues[0];</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                        secondBand[x*dimY+y] = currentModel-&gt;m_eigenvalues[1];</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                    }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                    <span class="keywordflow">if</span>(getMagnetizationData)</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                    {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                        magnetization[x*dimY+y] = currentModel-&gt;ApplySigmaZ(0);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                    }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a> &amp;&amp; mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a948a6b1b3daa673cc4ebd93eb0af6770">m_lastTask</a> &gt;= (<span class="keywordtype">int</span>)counter) <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                    progress.<a class="code" href="classutilities_1_1LoadBar.html#ac79a83299362ed622c9d5fc24106d555">Display</a>(counter+1);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a2d11fc59d54199d37f4627dc645dff93">AdditionalInfo</a>()&lt;&lt;std::endl;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="comment">//  Call MPI Gather on the energy and magnetization arrays</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordtype">double</span>* gatherBuffer = 0;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            gatherBuffer = <span class="keyword">new</span> <span class="keywordtype">double</span>[dimX*dimY];</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordtype">int</span> bufferSize = mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a948a6b1b3daa673cc4ebd93eb0af6770">m_lastTask</a> - mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#aafee6ab3a3b23174586b41f38da96bab">m_firstTask</a> +1;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">if</span>(getEnergyData)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            MPI_Status status;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a891ad0d4731f9a66311170d22f32b9e4">Gather</a>(lowerBand+mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#aafee6ab3a3b23174586b41f38da96bab">m_firstTask</a>, bufferSize, gatherBuffer, dimX*dimY, 0, mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a7e00700c79360216f60abafad2b0ab1f">m_comm</a>, status);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                memcpy(lowerBand, gatherBuffer, dimX*dimY*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a891ad0d4731f9a66311170d22f32b9e4">Gather</a>(secondBand+mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#aafee6ab3a3b23174586b41f38da96bab">m_firstTask</a>, bufferSize, gatherBuffer, dimX*dimY, 0, mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a7e00700c79360216f60abafad2b0ab1f">m_comm</a>, status);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                memcpy(secondBand, gatherBuffer, dimX*dimY*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keywordflow">if</span>(getMagnetizationData)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            MPI_Status status;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a891ad0d4731f9a66311170d22f32b9e4">Gather</a>(magnetization+mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#aafee6ab3a3b23174586b41f38da96bab">m_firstTask</a>, bufferSize, gatherBuffer, dimX*dimY, 0, mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a7e00700c79360216f60abafad2b0ab1f">m_comm</a>, status);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                memcpy(magnetization, gatherBuffer, dimX*dimY*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="keyword">delete</span>[] gatherBuffer;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            <span class="keywordflow">if</span>(getEnergyData)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                <span class="comment">//  Calculate band width of lowest band    </span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                bandWidth = *std::max_element(lowerBand,lowerBand+dimX*dimY)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                          - *std::min_element(lowerBand,lowerBand+dimX*dimY);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                <span class="keywordtype">double</span> bandGapList[dimX*dimY];</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> i=0;i&lt;dimX*dimY;++i)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                    bandGapList[i] = secondBand[i] - lowerBand[i];   </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                bandGap = *std::min_element(bandGapList, bandGapList+dimX*dimY);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    }</div>
<div class="ttc" id="namespacediagonalization_html_ab6352a2fe0c11db386c8f3e4fc09c38d"><div class="ttname"><a href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">diagonalization::iSize_t</a></div><div class="ttdeci">uint32_t iSize_t</div><div class="ttdef"><b>Definition:</b> <a href="orbital__and__state__defs_8hpp_source.html#l00043">orbital_and_state_defs.hpp:43</a></div></div>
<div class="ttc" id="classutilities_1_1LoadBar_html_ac79a83299362ed622c9d5fc24106d555"><div class="ttname"><a href="classutilities_1_1LoadBar.html#ac79a83299362ed622c9d5fc24106d555">utilities::LoadBar::Display</a></div><div class="ttdeci">void Display(const long int x) const </div><div class="ttdef"><b>Definition:</b> <a href="load__bar_8hpp_source.html#l00074">load_bar.hpp:74</a></div></div>
<div class="ttc" id="namespacediagonalization_1_1reciprocalLattice_html_a09fc4b1306501141a270fa90bd159fe1"><div class="ttname"><a href="namespacediagonalization_1_1reciprocalLattice.html#a09fc4b1306501141a270fa90bd159fe1">diagonalization::reciprocalLattice::G2</a></div><div class="ttdeci">static const utilities::LatticeVector2D&lt; double &gt; G2(0.866025403784438646763723170753,-1.5)</div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a58a92efc3951241eb3548b58bdf2c5ab"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a58a92efc3951241eb3548b58bdf2c5ab">utilities::MpiWrapper::DivideTasks</a></div><div class="ttdeci">void DivideTasks(const int id, const int nbrTasks, int nbrProcs, int *firstTask, int *lastTask, const bool display) const </div><div class="ttdoc">DivideTasks divides up nbrTasks tasks amongst nbrProcs processes On the processor labelled by the ide...</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8cpp_source.html#l00166">mpi_wrapper.cpp:166</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_aafee6ab3a3b23174586b41f38da96bab"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#aafee6ab3a3b23174586b41f38da96bab">utilities::MpiWrapper::m_firstTask</a></div><div class="ttdeci">int m_firstTask</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8hpp_source.html#l00061">mpi_wrapper.hpp:61</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a891ad0d4731f9a66311170d22f32b9e4"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a891ad0d4731f9a66311170d22f32b9e4">utilities::MpiWrapper::Gather</a></div><div class="ttdeci">void Gather(T *sendBuffer, int sendCount, T *recvBuffer, int recvCount, int gatherId, MPI_Comm comm, MPI_Status status) const </div><div class="ttdoc">A function to implement MPI Gather, but with different sizes of buffer on each node (the standard MPI...</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8hpp_source.html#l00147">mpi_wrapper.hpp:147</a></div></div>
<div class="ttc" id="namespaceutilities_html_a8bd217ae821e52872836b15f651f5d9f"><div class="ttname"><a href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a></div><div class="ttdeci">Cout cout</div><div class="ttdef"><b>Definition:</b> <a href="optical__flux__lattice__noninteracting__model_8cpp_source.html#l00035">optical_flux_lattice_noninteracting_model.cpp:35</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a7e00700c79360216f60abafad2b0ab1f"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a7e00700c79360216f60abafad2b0ab1f">utilities::MpiWrapper::m_comm</a></div><div class="ttdeci">MPI_Comm m_comm</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8hpp_source.html#l00069">mpi_wrapper.hpp:69</a></div></div>
<div class="ttc" id="classutilities_1_1Cout_html_a6219e39487852117bfc3c83dd1b073b1"><div class="ttname"><a href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">utilities::Cout::SecondaryOutput</a></div><div class="ttdeci">std::ostream &amp; SecondaryOutput()</div><div class="ttdef"><b>Definition:</b> <a href="cout__tools_8hpp_source.html#l00125">cout_tools.hpp:125</a></div></div>
<div class="ttc" id="classutilities_1_1Cout_html_a2d11fc59d54199d37f4627dc645dff93"><div class="ttname"><a href="classutilities_1_1Cout.html#a2d11fc59d54199d37f4627dc645dff93">utilities::Cout::AdditionalInfo</a></div><div class="ttdeci">std::ostream &amp; AdditionalInfo()</div><div class="ttdef"><b>Definition:</b> <a href="cout__tools_8hpp_source.html#l00132">cout_tools.hpp:132</a></div></div>
<div class="ttc" id="namespacediagonalization_1_1reciprocalLattice_html_aa61393cdc02028a0375aa5071f06cb86"><div class="ttname"><a href="namespacediagonalization_1_1reciprocalLattice.html#aa61393cdc02028a0375aa5071f06cb86">diagonalization::reciprocalLattice::G1</a></div><div class="ttdeci">static const utilities::LatticeVector2D&lt; double &gt; G1(-0.866025403784438646763723170753,-1.5)</div></div>
<div class="ttc" id="classutilities_1_1LoadBar_html"><div class="ttname"><a href="classutilities_1_1LoadBar.html">utilities::LoadBar</a></div><div class="ttdoc">A class to display a progress bar. </div><div class="ttdef"><b>Definition:</b> <a href="load__bar_8hpp_source.html#l00039">load_bar.hpp:39</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a948a6b1b3daa673cc4ebd93eb0af6770"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a948a6b1b3daa673cc4ebd93eb0af6770">utilities::MpiWrapper::m_lastTask</a></div><div class="ttdeci">int m_lastTask</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8hpp_source.html#l00064">mpi_wrapper.hpp:64</a></div></div>
<div class="ttc" id="classutilities_1_1LoadBar_html_a744cf589bf2d35dfda32af5d3ba4185d"><div class="ttname"><a href="classutilities_1_1LoadBar.html#a744cf589bf2d35dfda32af5d3ba4185d">utilities::LoadBar::Initialize</a></div><div class="ttdeci">void Initialize(const long int max)</div><div class="ttdef"><b>Definition:</b> <a href="load__bar_8hpp_source.html#l00058">load_bar.hpp:58</a></div></div>
<div class="ttc" id="classutilities_1_1LatticeVector2D_html"><div class="ttname"><a href="classutilities_1_1LatticeVector2D.html">utilities::LatticeVector2D&lt; double &gt;</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a0f670cb88d82d9c815e111de5e76ae3e"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">utilities::MpiWrapper::m_id</a></div><div class="ttdeci">int m_id</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8hpp_source.html#l00056">mpi_wrapper.hpp:56</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a0615e4621e3e3fe7c42f6e5bc0f00d6a"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a0615e4621e3e3fe7c42f6e5bc0f00d6a">utilities::MpiWrapper::m_nbrProcs</a></div><div class="ttdeci">int m_nbrProcs</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8hpp_source.html#l00054">mpi_wrapper.hpp:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a88eed09a62247d42c450dd9f04fc8739"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void diagonalization::NonInteractingOflModelGrid::CalculateSpatialWaveFunctions </td>
          <td>(</td>
          <td class="paramtype">boost::program_options::variables_map *&#160;</td>
          <td class="paramname"><em>optionList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structutilities_1_1MpiWrapper.html">utilities::MpiWrapper</a> &amp;&#160;</td>
          <td class="paramname"><em>mpi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A function to generate the single-particle orbitals. </p>
<p>psi^sigma_{kx,ky} (r) = |&lt;r,sigma|kx,ky&gt;|^2 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">optionList</td><td>Command line arguments </td></tr>
    <tr><td class="paramname">mpi</td><td>Instance of the mpi wrapper class </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="noninteracting__ofl__model__grid_8cpp_source.html#l00964">964</a> of file <a class="el" href="noninteracting__ofl__model__grid_8cpp_source.html">noninteracting_ofl_model_grid.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        { </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a903fe4ad596cdce91e00004bc21b7e6a">MainOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\t CALCULATING MAPPING TO SPATIAL WAVE FUNCTIONS&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        }</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        NonInteractingOflModelData params = NonInteractingOflModelData(optionList, mpi);          </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <span class="keywordtype">double</span> matrixElementTol;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> minBlochCutOff;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <span class="keywordtype">bool</span> useWannierBasis;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> dimX;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> dimY;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> realGridDim;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <span class="keywordtype">double</span> offsetX;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="keywordtype">double</span> offsetY;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <span class="keywordtype">double</span> gridSpacing;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        {</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            <span class="keywordtype">int</span> getBasis;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, matrixElementTol, <span class="stringliteral">&quot;tol&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, realGridDim, <span class="stringliteral">&quot;calculate-spatial-wavefunctions&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, dimX, <span class="stringliteral">&quot;x-grid&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, dimY, <span class="stringliteral">&quot;y-grid&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, getBasis, <span class="stringliteral">&quot;sptial-basis&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, minBlochCutOff, <span class="stringliteral">&quot;x-cut&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, offsetX, <span class="stringliteral">&quot;x-grid-shift&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, offsetY, <span class="stringliteral">&quot;y-grid-shift&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, gridSpacing, <span class="stringliteral">&quot;grid-spacing&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            <span class="keywordflow">if</span>(1 == getBasis)</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            {</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                useWannierBasis = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            }</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                useWannierBasis = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            }</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        }</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a34ac9d5bfd351da9b7696b5652eb95d5">ExitFlagTest</a>();</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">Sync</a>(&amp;matrixElementTol, 1, 0);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">Sync</a>(&amp;realGridDim, 1, 0);</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">Sync</a>(&amp;useWannierBasis, 1, 0);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">Sync</a>(&amp;dimX, 1, 0);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">Sync</a>(&amp;dimY, 1, 0);</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">Sync</a>(&amp;minBlochCutOff, 1, 0);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">Sync</a>(&amp;offsetX, 1, 0);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">Sync</a>(&amp;offsetY, 1, 0);</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">Sync</a>(&amp;gridSpacing, 1, 0);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        params.MpiSynchronize(0, mpi);</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <span class="keywordflow">if</span>((<span class="keywordtype">int</span>)(realGridDim*realGridDim)&lt;mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0615e4621e3e3fe7c42f6e5bc0f00d6a">m_nbrProcs</a>)</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        {</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            {</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                std::cerr&lt;&lt;<span class="stringliteral">&quot;\n\tERROR IN CalculateSpatialWaveFunctions: number of nodes exceeds grid size&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            }</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            exit(EXIT_FAILURE);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        }<span class="comment"></span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">        //////      First generate the Bloch wave functions     ////////////////////</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment"></span>        NonInteractingOflModel* blochWaveFunctionTable = <span class="keyword">new</span> NonInteractingOflModel[dimX*dimY]; </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        this-&gt;<a class="code" href="classdiagonalization_1_1NonInteractingOflModelGrid.html#a8b31798ef7bf946b3bc9eeb8f6d6c726">GenerateBlochWaveFunctionTable</a>(minBlochCutOff, dimX, dimY, offsetX, offsetY, blochWaveFunctionTable, &amp;params, mpi);<span class="comment"></span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">        //////      If required, calculate the change of basis matrix       ////////</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment"></span>        <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>* basisChangeMatrix = 0;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        <span class="keywordflow">if</span>(useWannierBasis)</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        {</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;            <span class="comment">//  Allocate space to store the change of basis matrix U_{(x,ky),(kx,ky)}</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            basisChangeMatrix = <span class="keyword">new</span> <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>[dimX*dimY*dimX*dimY];</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            this-&gt;<a class="code" href="classdiagonalization_1_1NonInteractingOflModelGrid.html#a7bcb8ebb726884935e902529edd9247d">GenerateWannierCoefficients</a>(dimX, dimY, offsetX, blochWaveFunctionTable, basisChangeMatrix, mpi);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        }<span class="comment"></span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">        //////      Convert to spatial wave functions on a real space grid     /////</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment"></span>        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        {</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">SecondaryOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\t- CONVERTING TO SPATIAL WAVE FUNCTION GRID&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        }</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        <span class="comment">//  A container to store the map between the Bloch function basis and the associated</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        <span class="comment">//  real-space wave functions psi^sigma_{kx,ky} (r)</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <a class="code" href="classutilities_1_1MultiHashMap.html">utilities::MultiHashMap&lt;double&gt;</a> spatialWaveFunctionTable;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        <span class="comment">//  For parallel processes, divide up tasks amongst available nodes</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a58a92efc3951241eb3548b58bdf2c5ab">DivideTasks</a>(mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>, realGridDim*realGridDim, mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0615e4621e3e3fe7c42f6e5bc0f00d6a">m_nbrProcs</a>, &amp;mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#aafee6ab3a3b23174586b41f38da96bab">m_firstTask</a>, &amp;mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a948a6b1b3daa673cc4ebd93eb0af6770">m_lastTask</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> counter  = 0;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <a class="code" href="classutilities_1_1LoadBar.html">utilities::LoadBar</a> progress;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        {</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;            progress.<a class="code" href="classutilities_1_1LoadBar.html#a744cf589bf2d35dfda32af5d3ba4185d">Initialize</a>(mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a948a6b1b3daa673cc4ebd93eb0af6770">m_lastTask</a> - mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#aafee6ab3a3b23174586b41f38da96bab">m_firstTask</a>+1);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        }</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> rx=0; rx&lt;realGridDim; ++rx)</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        {</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> ry=0; ry&lt;realGridDim; ++ry, ++counter)</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;            {  </div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                <span class="keywordflow">if</span>(mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#aafee6ab3a3b23174586b41f38da96bab">m_firstTask</a> &lt;= (<span class="keywordtype">int</span>)counter &amp;&amp; mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a948a6b1b3daa673cc4ebd93eb0af6770">m_lastTask</a> &gt;= (<span class="keywordtype">int</span>)counter)</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                    <span class="keywordflow">if</span>(useWannierBasis)</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                    {</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                        <span class="comment">//  If we are using the Wannier basis then we need to include the change</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                        <span class="comment">//  of basis in order to plot the spatial wave functions. The wave </span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                        <span class="comment">//  functions are given by</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                        <span class="comment">//</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                        <span class="comment">//  psi^sigma_{x,ky} (r) = exp(-2*I*PI*offsetX x/N_x) sum_{k_x=0}^{N_x-1} exp(-2*I*pi*k_x*x/N_x) </span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                        <span class="comment">//  {[[lambda_x(kx)]^kx]/product_{kappa=0}^{kx} A_x (kappa,ky)} sum_G a^{kx,ky}_{G,sigma} exp^(ir.(G+{kx,ky})</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                        <span class="comment">//  This can be achieved by performing a set of N_y 1D Fourier transforms</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                        <span class="comment">//  Allocate memory to store input/outputs of Fourier transforms</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                        <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>* fourierCoefficientsUp   = <span class="keyword">new</span> <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>[dimX*dimY];</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                        <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>* outputCoefficientsUp    = <span class="keyword">new</span> <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>[dimX*dimY];</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                        <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>* fourierCoefficientsDown = <span class="keyword">new</span> <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>[dimX*dimY];</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                        <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>* outputCoefficientsDown  = <span class="keyword">new</span> <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>[dimX*dimY];</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                        <span class="comment">//  Populate the Fourier transform inputs</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                        NonInteractingOflModel*  p_blochTable = blochWaveFunctionTable;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                        <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> ky=0; ky&lt;dimY; ++ky)</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                        {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                            <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> kx=0; kx&lt;dimX; ++kx, ++p_blochTable)</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                            {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                                <span class="comment">//  This value is given by</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                                <span class="comment">//  {[[lambda_x(kx)]^kx]/product_{kappa=0}^{kx} A_x (kappa,ky)} sum_G a^{kx,ky}_{G,sigma} exp^(ir.(G+{kx,ky})</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                                <span class="comment">//  Note that the values stored in the change of basis matrix are</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                                <span class="comment">//  U[x,ky,kx,ky] = exp(-2*I*PI*offsetX x/N_x) exp(-2*I*pi*k_x*x/N_x)/sqrt(N_x)*{[[lambda_x(kx)]^kx]/product_{kappa=0}^{kx} A_x (kappa,ky)}</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                                <span class="comment">//  Since we don&#39;t need the complex exponential part,</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                                <span class="comment">//  (as it will be implemted by the Fourier transform)</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                                <span class="comment">//  we need only extract U[0,ky,kx,ky]*sqrt(N_x)</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                                </div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = (ky)*dimX*dimY+(ky*dimX+kx);</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                                fourierCoefficientsUp[ky*dimX+kx]   = basisChangeMatrix[index]*sqrt(dimX)*p_blochTable-&gt;GetSpatialWaveFunction(<a class="code" href="namespacediagonalization.html#a2f56f91f59248660e9f54c1589aa3738a78bbafaa5b5635a03a3783ce9c37406a">_SPIN_UP_</a>, rx, ry, gridSpacing);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                                fourierCoefficientsDown[ky*dimX+kx] = basisChangeMatrix[index]*sqrt(dimX)*p_blochTable-&gt;GetSpatialWaveFunction(<a class="code" href="namespacediagonalization.html#a2f56f91f59248660e9f54c1589aa3738adf9bc42d5a4ca88c6c33b26aeb450025">_SPIN_DOWN_</a>, rx, ry, gridSpacing);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                            }</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                        }</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                        <span class="comment">//  Perform the set of transforms</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                        <a class="code" href="namespaceutilities.html#ab535008cab9192c3da1bbca22e841f38">utilities::DiscreteFourierTransform1D</a>(dimX, dimY, fourierCoefficientsUp, outputCoefficientsUp, FFTW_BACKWARD);</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                        <a class="code" href="namespaceutilities.html#ab535008cab9192c3da1bbca22e841f38">utilities::DiscreteFourierTransform1D</a>(dimX, dimY, fourierCoefficientsDown, outputCoefficientsDown, FFTW_BACKWARD);</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                        <span class="comment">//  Deallocate memory for Fourier transforms</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                        <span class="keyword">delete</span>[] fourierCoefficientsUp;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                        <span class="keyword">delete</span>[] fourierCoefficientsDown;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                        <span class="comment">//  Store the set of coefficients psi^sigma_{x,ky} (r)</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                        <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>* p_outputCoefficientsUp = outputCoefficientsUp;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                        <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>* p_outputCoefficientsDown = outputCoefficientsDown;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                        <a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> combinedR = this-&gt;<a class="code" href="classdiagonalization_1_1NonInteractingOflModelGrid.html#a6b324911df2644e84609706b69cafd97">CombineIndexes</a>(rx, ry, realGridDim);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                        <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> ky=0; ky&lt;dimY; ++ky)</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                        {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                            <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> x=0; x&lt;dimX; ++x, ++p_outputCoefficientsUp, ++p_outputCoefficientsDown)</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                            {         </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                                <a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> combinedK = this-&gt;<a class="code" href="classdiagonalization_1_1NonInteractingOflModelGrid.html#a6b324911df2644e84609706b69cafd97">CombineIndexes</a>(x, ky, dimY);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                                spatialWaveFunctionTable.<a class="code" href="classutilities_1_1MultiHashMap.html#a4d35fbe28c00398214fc75c83cfae79a">Insert</a>(<a class="code" href="namespaceutilities.html#acb04e305126905376344007e049f9ae8">utilities::Key</a>(combinedK, combinedR, (<span class="keywordtype">bool</span>)<a class="code" href="namespacediagonalization.html#a2f56f91f59248660e9f54c1589aa3738a78bbafaa5b5635a03a3783ce9c37406a">_SPIN_UP_</a>)) = abs(*p_outputCoefficientsUp)*abs(*p_outputCoefficientsUp);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                                spatialWaveFunctionTable.<a class="code" href="classutilities_1_1MultiHashMap.html#a4d35fbe28c00398214fc75c83cfae79a">Insert</a>(<a class="code" href="namespaceutilities.html#acb04e305126905376344007e049f9ae8">utilities::Key</a>(combinedK, combinedR, (<span class="keywordtype">bool</span>)<a class="code" href="namespacediagonalization.html#a2f56f91f59248660e9f54c1589aa3738adf9bc42d5a4ca88c6c33b26aeb450025">_SPIN_DOWN_</a>)) = abs(*p_outputCoefficientsDown)*abs(*p_outputCoefficientsDown);</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                            }</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                        }</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                        <span class="comment">//  Deallocate memory for Fourier transform outputs</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                        <span class="keyword">delete</span>[] outputCoefficientsUp;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                        <span class="keyword">delete</span>[] outputCoefficientsDown;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                    }</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                    {</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                        <span class="comment">//  If we use the regular Bloch wave function basis, then the spatial</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                        <span class="comment">//  wave functions are given by the sums of Bloch coefficients we&#39;ve</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                        <span class="comment">//  already calculated</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                        <span class="comment">//  psi^sigma_{kx,ky} (r) = sum_G a^{kx,ky}_{G,sigma} exp^(ir.(G+{kx,ky})</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                        <a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> combinedR = this-&gt;<a class="code" href="classdiagonalization_1_1NonInteractingOflModelGrid.html#a6b324911df2644e84609706b69cafd97">CombineIndexes</a>(rx, ry, realGridDim);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                        NonInteractingOflModel*  p_blochTable = blochWaveFunctionTable;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                        <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> ky=0; ky&lt;dimY; ++ky)</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                        {</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                            <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> kx=0; kx&lt;dimX; ++kx, ++p_blochTable)</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                            {            </div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                                <a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> combinedK = this-&gt;<a class="code" href="classdiagonalization_1_1NonInteractingOflModelGrid.html#a6b324911df2644e84609706b69cafd97">CombineIndexes</a>(kx, ky, dimY);</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                                <span class="keywordtype">double</span> absValueUp = abs(p_blochTable-&gt;GetSpatialWaveFunction(_SPIN_UP_, rx, ry, gridSpacing));</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                                <span class="keywordtype">double</span> absValueDown = abs(p_blochTable-&gt;GetSpatialWaveFunction(<a class="code" href="namespacediagonalization.html#a2f56f91f59248660e9f54c1589aa3738adf9bc42d5a4ca88c6c33b26aeb450025">_SPIN_DOWN_</a>, rx, ry, gridSpacing));</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                                spatialWaveFunctionTable.<a class="code" href="classutilities_1_1MultiHashMap.html#a4d35fbe28c00398214fc75c83cfae79a">Insert</a>(<a class="code" href="namespaceutilities.html#acb04e305126905376344007e049f9ae8">utilities::Key</a>(combinedK, combinedR, (<span class="keywordtype">bool</span>)_SPIN_UP_)) = absValueUp;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                                spatialWaveFunctionTable.<a class="code" href="classutilities_1_1MultiHashMap.html#a4d35fbe28c00398214fc75c83cfae79a">Insert</a>(<a class="code" href="namespaceutilities.html#acb04e305126905376344007e049f9ae8">utilities::Key</a>(combinedK, combinedR, (<span class="keywordtype">bool</span>)<a class="code" href="namespacediagonalization.html#a2f56f91f59248660e9f54c1589aa3738adf9bc42d5a4ca88c6c33b26aeb450025">_SPIN_DOWN_</a>)) = absValueDown;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                            }</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                        }</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                    }</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                    <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a> &amp;&amp; mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a948a6b1b3daa673cc4ebd93eb0af6770">m_lastTask</a> &gt;= (<span class="keywordtype">int</span>)counter) <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                    {</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                        progress.<a class="code" href="classutilities_1_1LoadBar.html#ac79a83299362ed622c9d5fc24106d555">Display</a>(counter+1);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                    }</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                }</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            }</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        }</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        {</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a2d11fc59d54199d37f4627dc645dff93">AdditionalInfo</a>()&lt;&lt;std::endl;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        }<span class="comment"></span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="comment">        //////      Output spatial wave function data to a text file        ////////        </span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment"></span>        std::stringstream dataFileName;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        {   </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            std::string outPath;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, outPath, <span class="stringliteral">&quot;out-path&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;            dataFileName.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;            dataFileName &lt;&lt; outPath &lt;&lt; <span class="stringliteral">&quot;/spatial_wave_function_kx_&quot;</span> &lt;&lt; dimX &lt;&lt; <span class="stringliteral">&quot;_ky_&quot;</span> &lt;&lt; dimY;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            <span class="keywordtype">bool</span> useSql;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, useSql, <span class="stringliteral">&quot;use-sql&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;            <span class="keywordflow">if</span>(useSql)</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;            {</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> sqlId;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, sqlId, <span class="stringliteral">&quot;sql-id&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                dataFileName &lt;&lt; <span class="stringliteral">&quot;_id_&quot;</span> &lt;&lt; sqlId;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            }</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            dataFileName &lt;&lt; <span class="stringliteral">&quot;_grid_size_&quot;</span> &lt;&lt; realGridDim;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            <span class="keywordflow">if</span>(useWannierBasis)</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            {</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                dataFileName &lt;&lt; <span class="stringliteral">&quot;_wannier_basis&quot;</span>;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            }</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            dataFileName &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        }</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        <a class="code" href="namespaceio.html#a21deb8bdc22417a8eb07113769d6c601">io::fileFormat_t</a> format = <a class="code" href="namespaceio.html#a21deb8bdc22417a8eb07113769d6c601ac78d869c7c1c4a0f9c801afc7cca4ce8">io::_TEXT_</a>;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        std::ofstream f_out;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        {</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;            <a class="code" href="namespaceutilities.html#a85f6e5cd6f08f4e47e1a00c3ebebc827">GenFileStream</a>(f_out, dataFileName.str(), format, <a class="code" href="optical__flux__lattice__noninteracting__model_8cpp.html#a1a7112d51c59f426cab52975031ff6e7">mpi</a>);</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        }</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a34ac9d5bfd351da9b7696b5652eb95d5">ExitFlagTest</a>();</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;        spatialWaveFunctionTable.<a class="code" href="classutilities_1_1MultiHashMap.html#a09893f5a6d8a56424e361803da18dc4d">ToFile</a>(f_out, format, 3, mpi);</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        <span class="keywordflow">if</span>(f_out.is_open())</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        {</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;            f_out.close();</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;        }</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;        {   </div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">SecondaryOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tFinished writing spatial wave funciton values to a file. See the file here: &quot;</span>&lt;&lt;dataFileName.str()&lt;&lt;std::endl;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        }</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    }</div>
<div class="ttc" id="namespacediagonalization_html_ab6352a2fe0c11db386c8f3e4fc09c38d"><div class="ttname"><a href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">diagonalization::iSize_t</a></div><div class="ttdeci">uint32_t iSize_t</div><div class="ttdef"><b>Definition:</b> <a href="orbital__and__state__defs_8hpp_source.html#l00043">orbital_and_state_defs.hpp:43</a></div></div>
<div class="ttc" id="namespacediagonalization_html_a2f56f91f59248660e9f54c1589aa3738a78bbafaa5b5635a03a3783ce9c37406a"><div class="ttname"><a href="namespacediagonalization.html#a2f56f91f59248660e9f54c1589aa3738a78bbafaa5b5635a03a3783ce9c37406a">diagonalization::_SPIN_UP_</a></div><div class="ttdef"><b>Definition:</b> <a href="noninteracting__ofl__model_8hpp_source.html#l00058">noninteracting_ofl_model.hpp:58</a></div></div>
<div class="ttc" id="classdiagonalization_1_1NonInteractingOflModelGrid_html_a7bcb8ebb726884935e902529edd9247d"><div class="ttname"><a href="classdiagonalization_1_1NonInteractingOflModelGrid.html#a7bcb8ebb726884935e902529edd9247d">diagonalization::NonInteractingOflModelGrid::GenerateWannierCoefficients</a></div><div class="ttdeci">void GenerateWannierCoefficients(const iSize_t dimX, const iSize_t dimY, const double offsetX, NonInteractingOflModel *blochTable, dcmplx *M, const utilities::MpiWrapper &amp;mpi)</div><div class="ttdoc">Generate the set of coefficients and phase factors required to change the single particle orbital bas...</div><div class="ttdef"><b>Definition:</b> <a href="noninteracting__ofl__model__grid_8cpp_source.html#l00782">noninteracting_ofl_model_grid.cpp:782</a></div></div>
<div class="ttc" id="classutilities_1_1LoadBar_html_ac79a83299362ed622c9d5fc24106d555"><div class="ttname"><a href="classutilities_1_1LoadBar.html#ac79a83299362ed622c9d5fc24106d555">utilities::LoadBar::Display</a></div><div class="ttdeci">void Display(const long int x) const </div><div class="ttdef"><b>Definition:</b> <a href="load__bar_8hpp_source.html#l00074">load_bar.hpp:74</a></div></div>
<div class="ttc" id="namespaceutilities_html_ab535008cab9192c3da1bbca22e841f38"><div class="ttname"><a href="namespaceutilities.html#ab535008cab9192c3da1bbca22e841f38">utilities::DiscreteFourierTransform1D</a></div><div class="ttdeci">void DiscreteFourierTransform1D(int N, int M, dcmplx *inputs, dcmplx *outputs, int sign)</div><div class="ttdoc">This function performs a series of 1D discrete Fourier transforms. </div><div class="ttdef"><b>Definition:</b> <a href="fftw__wrapper_8cpp_source.html#l00036">fftw_wrapper.cpp:36</a></div></div>
<div class="ttc" id="classutilities_1_1MultiHashMap_html"><div class="ttname"><a href="classutilities_1_1MultiHashMap.html">utilities::MultiHashMap&lt; double &gt;</a></div></div>
<div class="ttc" id="classdiagonalization_1_1NonInteractingOflModelGrid_html_a6b324911df2644e84609706b69cafd97"><div class="ttname"><a href="classdiagonalization_1_1NonInteractingOflModelGrid.html#a6b324911df2644e84609706b69cafd97">diagonalization::NonInteractingOflModelGrid::CombineIndexes</a></div><div class="ttdeci">kState_t CombineIndexes(const kState_t x, const kState_t y, const iSize_t dim) const </div><div class="ttdef"><b>Definition:</b> <a href="noninteracting__ofl__model__grid_8cpp_source.html#l00035">noninteracting_ofl_model_grid.cpp:35</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a58a92efc3951241eb3548b58bdf2c5ab"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a58a92efc3951241eb3548b58bdf2c5ab">utilities::MpiWrapper::DivideTasks</a></div><div class="ttdeci">void DivideTasks(const int id, const int nbrTasks, int nbrProcs, int *firstTask, int *lastTask, const bool display) const </div><div class="ttdoc">DivideTasks divides up nbrTasks tasks amongst nbrProcs processes On the processor labelled by the ide...</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8cpp_source.html#l00166">mpi_wrapper.cpp:166</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a34ac9d5bfd351da9b7696b5652eb95d5"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a34ac9d5bfd351da9b7696b5652eb95d5">utilities::MpiWrapper::ExitFlagTest</a></div><div class="ttdeci">void ExitFlagTest()</div><div class="ttdoc">If the exitflag is set to true on the master node, then call Terminate. </div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8cpp_source.html#l00327">mpi_wrapper.cpp:327</a></div></div>
<div class="ttc" id="namespaceutilities_html_acb04e305126905376344007e049f9ae8"><div class="ttname"><a href="namespaceutilities.html#acb04e305126905376344007e049f9ae8">utilities::Key</a></div><div class="ttdeci">uint64_t Key(const uint32_t key1, const uint32_t key2)</div><div class="ttdoc">Function to generate a 64-bit hash key from 2 input arguments. </div><div class="ttdef"><b>Definition:</b> <a href="multi__key__hash_8hpp_source.html#l00059">multi_key_hash.hpp:59</a></div></div>
<div class="ttc" id="namespaceio_html_a21deb8bdc22417a8eb07113769d6c601ac78d869c7c1c4a0f9c801afc7cca4ce8"><div class="ttname"><a href="namespaceio.html#a21deb8bdc22417a8eb07113769d6c601ac78d869c7c1c4a0f9c801afc7cca4ce8">io::_TEXT_</a></div><div class="ttdef"><b>Definition:</b> <a href="io__wrapper_8hpp_source.html#l00023">io_wrapper.hpp:23</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_aafee6ab3a3b23174586b41f38da96bab"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#aafee6ab3a3b23174586b41f38da96bab">utilities::MpiWrapper::m_firstTask</a></div><div class="ttdeci">int m_firstTask</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8hpp_source.html#l00061">mpi_wrapper.hpp:61</a></div></div>
<div class="ttc" id="classutilities_1_1MultiHashMap_html_a09893f5a6d8a56424e361803da18dc4d"><div class="ttname"><a href="classutilities_1_1MultiHashMap.html#a09893f5a6d8a56424e361803da18dc4d">utilities::MultiHashMap::ToFile</a></div><div class="ttdeci">void ToFile(std::ofstream &amp;stream, const io::fileFormat_t format, const unsigned int nbrLabels, MpiWrapper &amp;mpi)</div><div class="ttdef"><b>Definition:</b> <a href="multi__key__hash_8hpp_source.html#l00810">multi_key_hash.hpp:810</a></div></div>
<div class="ttc" id="classutilities_1_1Cout_html_a903fe4ad596cdce91e00004bc21b7e6a"><div class="ttname"><a href="classutilities_1_1Cout.html#a903fe4ad596cdce91e00004bc21b7e6a">utilities::Cout::MainOutput</a></div><div class="ttdeci">std::ostream &amp; MainOutput()</div><div class="ttdef"><b>Definition:</b> <a href="cout__tools_8hpp_source.html#l00118">cout_tools.hpp:118</a></div></div>
<div class="ttc" id="namespaceutilities_html_a8bd217ae821e52872836b15f651f5d9f"><div class="ttname"><a href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a></div><div class="ttdeci">Cout cout</div><div class="ttdef"><b>Definition:</b> <a href="optical__flux__lattice__noninteracting__model_8cpp_source.html#l00035">optical_flux_lattice_noninteracting_model.cpp:35</a></div></div>
<div class="ttc" id="namespaceutilities_html_a0a4e0749cf92abf92f2b0290ae0639a6"><div class="ttname"><a href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">utilities::GetOption</a></div><div class="ttdeci">void GetOption(boost::program_options::variables_map *variables_map, T &amp;variable, const std::string name, const std::string location)</div><div class="ttdef"><b>Definition:</b> <a href="program__options__wrapper_8hpp_source.html#l00043">program_options_wrapper.hpp:43</a></div></div>
<div class="ttc" id="program__options__wrapper_8hpp_html_a546a3df1472df59c883c923d5f59663a"><div class="ttname"><a href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a></div><div class="ttdeci">#define _AT_</div><div class="ttdef"><b>Definition:</b> <a href="program__options__wrapper_8hpp_source.html#l00031">program_options_wrapper.hpp:31</a></div></div>
<div class="ttc" id="classutilities_1_1Cout_html_a6219e39487852117bfc3c83dd1b073b1"><div class="ttname"><a href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">utilities::Cout::SecondaryOutput</a></div><div class="ttdeci">std::ostream &amp; SecondaryOutput()</div><div class="ttdef"><b>Definition:</b> <a href="cout__tools_8hpp_source.html#l00125">cout_tools.hpp:125</a></div></div>
<div class="ttc" id="classutilities_1_1Cout_html_a2d11fc59d54199d37f4627dc645dff93"><div class="ttname"><a href="classutilities_1_1Cout.html#a2d11fc59d54199d37f4627dc645dff93">utilities::Cout::AdditionalInfo</a></div><div class="ttdeci">std::ostream &amp; AdditionalInfo()</div><div class="ttdef"><b>Definition:</b> <a href="cout__tools_8hpp_source.html#l00132">cout_tools.hpp:132</a></div></div>
<div class="ttc" id="optical__flux__lattice__noninteracting__model_8cpp_html_a1a7112d51c59f426cab52975031ff6e7"><div class="ttname"><a href="optical__flux__lattice__noninteracting__model_8cpp.html#a1a7112d51c59f426cab52975031ff6e7">mpi</a></div><div class="ttdeci">utilities::MpiWrapper mpi(utilities::cout)</div></div>
<div class="ttc" id="namespacediagonalization_html_a26ca92638e21ae8791b99ae7fa90dd4c"><div class="ttname"><a href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">diagonalization::kState_t</a></div><div class="ttdeci">uint16_t kState_t</div><div class="ttdoc">Define an unsigned quantum number index type (a 16 bit unsigned int) </div><div class="ttdef"><b>Definition:</b> <a href="orbital__and__state__defs_8hpp_source.html#l00039">orbital_and_state_defs.hpp:39</a></div></div>
<div class="ttc" id="classutilities_1_1MultiHashMap_html_a4d35fbe28c00398214fc75c83cfae79a"><div class="ttname"><a href="classutilities_1_1MultiHashMap.html#a4d35fbe28c00398214fc75c83cfae79a">utilities::MultiHashMap::Insert</a></div><div class="ttdeci">T &amp; Insert(const uint64_t key1)</div><div class="ttdoc">Function to append data to the map using a single index. </div><div class="ttdef"><b>Definition:</b> <a href="multi__key__hash_8hpp_source.html#l00774">multi_key_hash.hpp:774</a></div></div>
<div class="ttc" id="classutilities_1_1LoadBar_html"><div class="ttname"><a href="classutilities_1_1LoadBar.html">utilities::LoadBar</a></div><div class="ttdoc">A class to display a progress bar. </div><div class="ttdef"><b>Definition:</b> <a href="load__bar_8hpp_source.html#l00039">load_bar.hpp:39</a></div></div>
<div class="ttc" id="classdiagonalization_1_1NonInteractingOflModelGrid_html_a8b31798ef7bf946b3bc9eeb8f6d6c726"><div class="ttname"><a href="classdiagonalization_1_1NonInteractingOflModelGrid.html#a8b31798ef7bf946b3bc9eeb8f6d6c726">diagonalization::NonInteractingOflModelGrid::GenerateBlochWaveFunctionTable</a></div><div class="ttdeci">void GenerateBlochWaveFunctionTable(const iSize_t cutOff, const iSize_t dimX, const iSize_t dimY, const double offsetX, const double offsetY, NonInteractingOflModel *blochTable, const NonInteractingOflModelData *params, utilities::MpiWrapper &amp;mpi)</div><div class="ttdoc">Generate a table single-particle Hamiltonian solutions for a given k-space grid covering the Brilloui...</div><div class="ttdef"><b>Definition:</b> <a href="noninteracting__ofl__model__grid_8cpp_source.html#l00053">noninteracting_ofl_model_grid.cpp:53</a></div></div>
<div class="ttc" id="namespaceutilities_html_a85f6e5cd6f08f4e47e1a00c3ebebc827"><div class="ttname"><a href="namespaceutilities.html#a85f6e5cd6f08f4e47e1a00c3ebebc827">utilities::GenFileStream</a></div><div class="ttdeci">void GenFileStream(F &amp;stream, const std::string fileName, io::fileFormat_t format, utilities::MpiWrapper &amp;mpi)</div><div class="ttdef"><b>Definition:</b> <a href="io__wrapper_8hpp_source.html#l00035">io_wrapper.hpp:35</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a948a6b1b3daa673cc4ebd93eb0af6770"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a948a6b1b3daa673cc4ebd93eb0af6770">utilities::MpiWrapper::m_lastTask</a></div><div class="ttdeci">int m_lastTask</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8hpp_source.html#l00064">mpi_wrapper.hpp:64</a></div></div>
<div class="ttc" id="namespacediagonalization_html_a2f56f91f59248660e9f54c1589aa3738adf9bc42d5a4ca88c6c33b26aeb450025"><div class="ttname"><a href="namespacediagonalization.html#a2f56f91f59248660e9f54c1589aa3738adf9bc42d5a4ca88c6c33b26aeb450025">diagonalization::_SPIN_DOWN_</a></div><div class="ttdef"><b>Definition:</b> <a href="noninteracting__ofl__model_8hpp_source.html#l00058">noninteracting_ofl_model.hpp:58</a></div></div>
<div class="ttc" id="classutilities_1_1LoadBar_html_a744cf589bf2d35dfda32af5d3ba4185d"><div class="ttname"><a href="classutilities_1_1LoadBar.html#a744cf589bf2d35dfda32af5d3ba4185d">utilities::LoadBar::Initialize</a></div><div class="ttdeci">void Initialize(const long int max)</div><div class="ttdef"><b>Definition:</b> <a href="load__bar_8hpp_source.html#l00058">load_bar.hpp:58</a></div></div>
<div class="ttc" id="dcmplx__type__def_8hpp_html_a52196b4b274b585226e0614490f7defc"><div class="ttname"><a href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a></div><div class="ttdeci">std::complex&lt; double &gt; dcmplx</div><div class="ttdef"><b>Definition:</b> <a href="dcmplx__type__def_8hpp_source.html#l00014">dcmplx_type_def.hpp:14</a></div></div>
<div class="ttc" id="namespaceio_html_a21deb8bdc22417a8eb07113769d6c601"><div class="ttname"><a href="namespaceio.html#a21deb8bdc22417a8eb07113769d6c601">io::fileFormat_t</a></div><div class="ttdeci">fileFormat_t</div><div class="ttdef"><b>Definition:</b> <a href="io__wrapper_8hpp_source.html#l00023">io_wrapper.hpp:23</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a0f670cb88d82d9c815e111de5e76ae3e"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">utilities::MpiWrapper::m_id</a></div><div class="ttdeci">int m_id</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8hpp_source.html#l00056">mpi_wrapper.hpp:56</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a0615e4621e3e3fe7c42f6e5bc0f00d6a"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a0615e4621e3e3fe7c42f6e5bc0f00d6a">utilities::MpiWrapper::m_nbrProcs</a></div><div class="ttdeci">int m_nbrProcs</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8hpp_source.html#l00054">mpi_wrapper.hpp:54</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_ab7c5634cdbed7e4436b54b9ef619f85b"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">utilities::MpiWrapper::Sync</a></div><div class="ttdeci">void Sync(std::string &amp;buffer, int syncNode) const </div><div class="ttdoc">A function to MPI synchronize a string. </div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8cpp_source.html#l00345">mpi_wrapper.cpp:345</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6b324911df2644e84609706b69cafd97"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> diagonalization::NonInteractingOflModelGrid::CombineIndexes </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a>&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a>&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a>&#160;</td>
          <td class="paramname"><em>dim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function combines a set of 2D indexes into a single index </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>x index </td></tr>
    <tr><td class="paramname">y</td><td>y index </td></tr>
    <tr><td class="paramname">dim</td><td>Number of points on the grid </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="noninteracting__ofl__model__grid_8cpp_source.html#l00035">35</a> of file <a class="el" href="noninteracting__ofl__model__grid_8cpp_source.html">noninteracting_ofl_model_grid.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordflow">return</span> x*dim + y;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8b31798ef7bf946b3bc9eeb8f6d6c726"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void diagonalization::NonInteractingOflModelGrid::GenerateBlochWaveFunctionTable </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a>&#160;</td>
          <td class="paramname"><em>cutOff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a>&#160;</td>
          <td class="paramname"><em>dimX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a>&#160;</td>
          <td class="paramname"><em>dimY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>offsetX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>offsetY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdiagonalization_1_1NonInteractingOflModel.html">NonInteractingOflModel</a> *&#160;</td>
          <td class="paramname"><em>blochTable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdiagonalization_1_1NonInteractingOflModelData.html">NonInteractingOflModelData</a> *&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structutilities_1_1MpiWrapper.html">utilities::MpiWrapper</a> &amp;&#160;</td>
          <td class="paramname"><em>mpi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a table single-particle Hamiltonian solutions for a given k-space grid covering the Brillouin zone with dimX by dimY points. </p>
<p>Note: pass the address of an array of <a class="el" href="classdiagonalization_1_1NonInteractingOflModel.html" title="The NonInteractingOflModel class contains a matrix representation of the single particle optical flux...">NonInteractingOflModel</a> classes as the Bloch wave function look-up table</p>
<p>Note: This function is parallelized </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cutOff</td><td>Cut-off in range of reciprocal lattice vectors </td></tr>
    <tr><td class="paramname">dimX</td><td>Number of k-space points in G1-direction </td></tr>
    <tr><td class="paramname">dimY</td><td>Number of k-space points in G2-direction </td></tr>
    <tr><td class="paramname">offsetX</td><td>X offset in the map of k-space </td></tr>
    <tr><td class="paramname">offsetY</td><td>Y offset in the map of k-space </td></tr>
    <tr><td class="paramname">blochTable</td><td>Look-up table of Bloch wave functions </td></tr>
    <tr><td class="paramname">params</td><td>Parameter set defining the model </td></tr>
    <tr><td class="paramname">mpi</td><td>Instance of the mpi wrapper class </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="noninteracting__ofl__model__grid_8cpp_source.html#l00053">53</a> of file <a class="el" href="noninteracting__ofl__model__grid_8cpp_source.html">noninteracting_ofl_model_grid.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a2d11fc59d54199d37f4627dc645dff93">AdditionalInfo</a>()&lt;&lt;<span class="stringliteral">&quot;\n\t- GENERATING BLOCH WAVE FUNCTION TABLE (cut-off range &quot;</span>&lt;&lt;cutOff&lt;&lt;<span class="stringliteral">&quot;)&quot;</span>&lt;&lt;std::endl&lt;&lt;std::endl;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="comment">//  Generate a list of NonInteractingOflModel objects to store</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="comment">//  tables of Bloch wave function data</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a58a92efc3951241eb3548b58bdf2c5ab">DivideTasks</a>(mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>,dimX*dimY, mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0615e4621e3e3fe7c42f6e5bc0f00d6a">m_nbrProcs</a>, &amp;mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#aafee6ab3a3b23174586b41f38da96bab">m_firstTask</a>, &amp;mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a948a6b1b3daa673cc4ebd93eb0af6770">m_lastTask</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        NonInteractingOflModel oflModel(*params);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        oflModel.m_xBandCutOff = cutOff;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        oflModel.m_yBandCutOff = cutOff;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        oflModel.m_nbrBands = 1;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a9ebb8ca78b6ddca88653622f0331b599">DebuggingInfo</a>()&lt;&lt;<span class="stringliteral">&quot;\n\t- ALLOCATING ~&quot;</span>&lt;&lt;dimX*dimY*oflModel.GetDifferenceMatrixDimension()*<span class="keyword">sizeof</span>(<a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>)/(1024.0*1024.0)&lt;&lt;<span class="stringliteral">&quot; mb&quot;</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a9ebb8ca78b6ddca88653622f0331b599">DebuggingInfo</a>()&lt;&lt;<span class="stringliteral">&quot; to store Bloch wave function loop-up table.\n&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        oflModel.PopulateDifferenceMatrix();</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="classutilities_1_1LatticeVector2D.html">utilities::LatticeVector2D&lt;double&gt;</a> kVector(offsetX, offsetY);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <a class="code" href="classutilities_1_1LatticeVector2D.html">utilities::LatticeVector2D&lt;double&gt;</a> increment1(<a class="code" href="namespacediagonalization_1_1reciprocalLattice.html#aa61393cdc02028a0375aa5071f06cb86">reciprocalLattice::G1</a>, (<span class="keywordtype">double</span>)1/dimX);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <a class="code" href="classutilities_1_1LatticeVector2D.html">utilities::LatticeVector2D&lt;double&gt;</a> increment2(<a class="code" href="namespacediagonalization_1_1reciprocalLattice.html#a09fc4b1306501141a270fa90bd159fe1">reciprocalLattice::G2</a>, (<span class="keywordtype">double</span>)1/dimY);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> counter  = 0;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <a class="code" href="classutilities_1_1LoadBar.html">utilities::LoadBar</a> progress;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            progress.<a class="code" href="classutilities_1_1LoadBar.html#a744cf589bf2d35dfda32af5d3ba4185d">Initialize</a>(mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a948a6b1b3daa673cc4ebd93eb0af6770">m_lastTask</a> - mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#aafee6ab3a3b23174586b41f38da96bab">m_firstTask</a>+1);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        }        </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="comment">//  Allocate memory to store part of the result on each node</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        std::vector&lt;NonInteractingOflModel&gt; temp;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        NonInteractingOflModel dummy;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        temp.reserve(ceil((<span class="keywordtype">double</span>)mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0615e4621e3e3fe7c42f6e5bc0f00d6a">m_nbrProcs</a>/(dimX*dimY)));</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        MPI_Barrier(mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a7e00700c79360216f60abafad2b0ab1f">m_comm</a>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="comment">// Parallelize the the for loop by dividing the k-space grid calculations</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="comment">// up over a number of processors. </span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> x=0; x&lt;dimX; ++x, kVector-=<a class="code" href="namespacediagonalization_1_1reciprocalLattice.html#a09fc4b1306501141a270fa90bd159fe1">reciprocalLattice::G2</a>, kVector += increment1)   <span class="comment">//  Map out G1 direction</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> y=0; y&lt;dimY; ++y, kVector += increment2, ++counter)   <span class="comment">//  Map out G2 direction</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                <span class="keywordflow">if</span>(mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#aafee6ab3a3b23174586b41f38da96bab">m_firstTask</a> &lt;= (<span class="keywordtype">int</span>)counter &amp;&amp; mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a948a6b1b3daa673cc4ebd93eb0af6770">m_lastTask</a> &gt;= (<span class="keywordtype">int</span>)counter)</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                    oflModel.UpdateDifferenceDiagonal(kVector);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                    oflModel.DiagonalizeDifferenceMatrix();</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                    <span class="comment">//  Set the m_differenceMatrixPopulated to false so that the</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                    <span class="comment">//  full difference matrix is not coppied</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                    oflModel.m_differenceMatrixPopulated = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                    temp.push_back(oflModel);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                    <span class="comment">//  Reset the flag so that the difference matrix can be updated</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                    oflModel.m_differenceMatrixPopulated = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                    <span class="comment">//  Append empty class to the list to assist with the MPI sync function below</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                    temp.push_back(dummy);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a> &amp;&amp; mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a948a6b1b3daa673cc4ebd93eb0af6770">m_lastTask</a> &gt;= (<span class="keywordtype">int</span>)counter) <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                    progress.<a class="code" href="classutilities_1_1LoadBar.html#ac79a83299362ed622c9d5fc24106d555">Display</a>(counter+1);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a2d11fc59d54199d37f4627dc645dff93">AdditionalInfo</a>()&lt;&lt;std::endl;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="comment">//  Gather up all the calculated values and put them in a copy of the Bloch</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="comment">//  table on each node. Example (for objects T0,T1,T2,T3,T4) </span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="comment">//          NODE0       |       NODE1    |       NODE2</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="comment">//  INPUT:  T0 T1 _ _ _ |  _ _ T2 T3 _   |  _ _ _ _ T4 </span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="comment">//  (temp array)</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="comment">//  OUTPUT: all T0 to T4|  all T0 to T4  |  all T0 to T4</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="comment">//  (blochTable)</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        MPI_Barrier(mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a7e00700c79360216f60abafad2b0ab1f">m_comm</a>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        counter = 0;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordtype">int</span> proc_remain = std::min(mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0615e4621e3e3fe7c42f6e5bc0f00d6a">m_nbrProcs</a>, (<span class="keywordtype">int</span>)(dimX*dimY));</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordtype">int</span> taskRemain = dimX*dimY;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        NonInteractingOflModel* p_table = blochTable;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordtype">int</span> taskCounter = 0;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> node=0; node&lt;mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0615e4621e3e3fe7c42f6e5bc0f00d6a">m_nbrProcs</a>; ++node)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="keywordtype">int</span> taskProc = (int)floor((<span class="keywordtype">double</span>)taskRemain/proc_remain+0.5);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            proc_remain--;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            taskRemain -= taskProc;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p=0; p&lt;taskProc; ++p, ++taskCounter, ++p_table)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                p_table-&gt;MpiSynchrnoizedCopy(temp[taskCounter], node, mpi);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            } </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }</div>
<div class="ttc" id="namespacediagonalization_html_ab6352a2fe0c11db386c8f3e4fc09c38d"><div class="ttname"><a href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">diagonalization::iSize_t</a></div><div class="ttdeci">uint32_t iSize_t</div><div class="ttdef"><b>Definition:</b> <a href="orbital__and__state__defs_8hpp_source.html#l00043">orbital_and_state_defs.hpp:43</a></div></div>
<div class="ttc" id="classutilities_1_1LoadBar_html_ac79a83299362ed622c9d5fc24106d555"><div class="ttname"><a href="classutilities_1_1LoadBar.html#ac79a83299362ed622c9d5fc24106d555">utilities::LoadBar::Display</a></div><div class="ttdeci">void Display(const long int x) const </div><div class="ttdef"><b>Definition:</b> <a href="load__bar_8hpp_source.html#l00074">load_bar.hpp:74</a></div></div>
<div class="ttc" id="namespacediagonalization_1_1reciprocalLattice_html_a09fc4b1306501141a270fa90bd159fe1"><div class="ttname"><a href="namespacediagonalization_1_1reciprocalLattice.html#a09fc4b1306501141a270fa90bd159fe1">diagonalization::reciprocalLattice::G2</a></div><div class="ttdeci">static const utilities::LatticeVector2D&lt; double &gt; G2(0.866025403784438646763723170753,-1.5)</div></div>
<div class="ttc" id="classutilities_1_1Cout_html_a9ebb8ca78b6ddca88653622f0331b599"><div class="ttname"><a href="classutilities_1_1Cout.html#a9ebb8ca78b6ddca88653622f0331b599">utilities::Cout::DebuggingInfo</a></div><div class="ttdeci">std::ostream &amp; DebuggingInfo()</div><div class="ttdef"><b>Definition:</b> <a href="cout__tools_8hpp_source.html#l00139">cout_tools.hpp:139</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a58a92efc3951241eb3548b58bdf2c5ab"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a58a92efc3951241eb3548b58bdf2c5ab">utilities::MpiWrapper::DivideTasks</a></div><div class="ttdeci">void DivideTasks(const int id, const int nbrTasks, int nbrProcs, int *firstTask, int *lastTask, const bool display) const </div><div class="ttdoc">DivideTasks divides up nbrTasks tasks amongst nbrProcs processes On the processor labelled by the ide...</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8cpp_source.html#l00166">mpi_wrapper.cpp:166</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_aafee6ab3a3b23174586b41f38da96bab"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#aafee6ab3a3b23174586b41f38da96bab">utilities::MpiWrapper::m_firstTask</a></div><div class="ttdeci">int m_firstTask</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8hpp_source.html#l00061">mpi_wrapper.hpp:61</a></div></div>
<div class="ttc" id="namespaceutilities_html_a8bd217ae821e52872836b15f651f5d9f"><div class="ttname"><a href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a></div><div class="ttdeci">Cout cout</div><div class="ttdef"><b>Definition:</b> <a href="optical__flux__lattice__noninteracting__model_8cpp_source.html#l00035">optical_flux_lattice_noninteracting_model.cpp:35</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a7e00700c79360216f60abafad2b0ab1f"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a7e00700c79360216f60abafad2b0ab1f">utilities::MpiWrapper::m_comm</a></div><div class="ttdeci">MPI_Comm m_comm</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8hpp_source.html#l00069">mpi_wrapper.hpp:69</a></div></div>
<div class="ttc" id="classutilities_1_1Cout_html_a2d11fc59d54199d37f4627dc645dff93"><div class="ttname"><a href="classutilities_1_1Cout.html#a2d11fc59d54199d37f4627dc645dff93">utilities::Cout::AdditionalInfo</a></div><div class="ttdeci">std::ostream &amp; AdditionalInfo()</div><div class="ttdef"><b>Definition:</b> <a href="cout__tools_8hpp_source.html#l00132">cout_tools.hpp:132</a></div></div>
<div class="ttc" id="namespacediagonalization_1_1reciprocalLattice_html_aa61393cdc02028a0375aa5071f06cb86"><div class="ttname"><a href="namespacediagonalization_1_1reciprocalLattice.html#aa61393cdc02028a0375aa5071f06cb86">diagonalization::reciprocalLattice::G1</a></div><div class="ttdeci">static const utilities::LatticeVector2D&lt; double &gt; G1(-0.866025403784438646763723170753,-1.5)</div></div>
<div class="ttc" id="classutilities_1_1LoadBar_html"><div class="ttname"><a href="classutilities_1_1LoadBar.html">utilities::LoadBar</a></div><div class="ttdoc">A class to display a progress bar. </div><div class="ttdef"><b>Definition:</b> <a href="load__bar_8hpp_source.html#l00039">load_bar.hpp:39</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a948a6b1b3daa673cc4ebd93eb0af6770"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a948a6b1b3daa673cc4ebd93eb0af6770">utilities::MpiWrapper::m_lastTask</a></div><div class="ttdeci">int m_lastTask</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8hpp_source.html#l00064">mpi_wrapper.hpp:64</a></div></div>
<div class="ttc" id="classutilities_1_1LoadBar_html_a744cf589bf2d35dfda32af5d3ba4185d"><div class="ttname"><a href="classutilities_1_1LoadBar.html#a744cf589bf2d35dfda32af5d3ba4185d">utilities::LoadBar::Initialize</a></div><div class="ttdeci">void Initialize(const long int max)</div><div class="ttdef"><b>Definition:</b> <a href="load__bar_8hpp_source.html#l00058">load_bar.hpp:58</a></div></div>
<div class="ttc" id="dcmplx__type__def_8hpp_html_a52196b4b274b585226e0614490f7defc"><div class="ttname"><a href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a></div><div class="ttdeci">std::complex&lt; double &gt; dcmplx</div><div class="ttdef"><b>Definition:</b> <a href="dcmplx__type__def_8hpp_source.html#l00014">dcmplx_type_def.hpp:14</a></div></div>
<div class="ttc" id="classutilities_1_1LatticeVector2D_html"><div class="ttname"><a href="classutilities_1_1LatticeVector2D.html">utilities::LatticeVector2D&lt; double &gt;</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a0f670cb88d82d9c815e111de5e76ae3e"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">utilities::MpiWrapper::m_id</a></div><div class="ttdeci">int m_id</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8hpp_source.html#l00056">mpi_wrapper.hpp:56</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a0615e4621e3e3fe7c42f6e5bc0f00d6a"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a0615e4621e3e3fe7c42f6e5bc0f00d6a">utilities::MpiWrapper::m_nbrProcs</a></div><div class="ttdeci">int m_nbrProcs</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8hpp_source.html#l00054">mpi_wrapper.hpp:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7bcb8ebb726884935e902529edd9247d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void diagonalization::NonInteractingOflModelGrid::GenerateWannierCoefficients </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a>&#160;</td>
          <td class="paramname"><em>dimX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a>&#160;</td>
          <td class="paramname"><em>dimY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>offsetX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdiagonalization_1_1NonInteractingOflModel.html">NonInteractingOflModel</a> *&#160;</td>
          <td class="paramname"><em>blochTable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a> *&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structutilities_1_1MpiWrapper.html">utilities::MpiWrapper</a> &amp;&#160;</td>
          <td class="paramname"><em>mpi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate the set of coefficients and phase factors required to change the single particle orbital basis to the basis of hybrid localized Wannier states as defined in Eq 32 of PRB 86,085129 (2012) </p>
<p>The change of basis can be written as:</p>
<p>|x,k_y&gt; = exp(-2*I*PI*offsetX x/dimX) exp^{Iphi_y(x,ky)}/sqrt(dimX) sum_kx exp(-2*I*PI*kx x/dimX) {[[lambda_x(kx)]^kx]/product_{kappa=0}^{kx} A_x (kappa,ky)} |kx,ky&gt;</p>
<p>The change of basis can be encoded in a matrix:</p>
<p>c^+_{x,ky} = sum_{kx,ky} U_{(x,ky),(kx,ky)} c^+_{kx,ky}</p>
<p>OR</p>
<p>c^+_{kx,ky} = sum_{x,ky} U^-1_{(kx,ky),(x,ky)} c^+_{x,ky}</p>
<p>where U is unitary and diagonal in ky. Then</p>
<p>V_{(x,ky)_1,...,(x,ky)_4} = sum_{(kx,ky)_1,...,(kx,ky)_4)} V_{(kx,ky)_1,...,(kx,ky)_4}</p>
<ul>
<li>U^-1_{(kx,ky)_1,(x,ky)_1} U^-1_{(kx,ky)_2,(x,ky)_2}</li>
<li>U_{(x,ky)_3,(kx,ky)_3} U_{(x,ky)_4,(kx,ky)_4} </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dimX</td><td>X-dimension of k-space grid </td></tr>
    <tr><td class="paramname">dimY</td><td>Y-dimension of k-space grid </td></tr>
    <tr><td class="paramname">offsetX</td><td>Offset in the kx grid </td></tr>
    <tr><td class="paramname">blochTable</td><td>Table of Bloch wave functions corresponding to that k-space grid </td></tr>
    <tr><td class="paramname">M</td><td>A dimX*dimY by dimX*dimY matrix encoding the change of basis (to be populated) </td></tr>
    <tr><td class="paramname">mpi</td><td>Instance of the mpi wrapper class </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="noninteracting__ofl__model__grid_8cpp_source.html#l00782">782</a> of file <a class="el" href="noninteracting__ofl__model__grid_8cpp_source.html">noninteracting_ofl_model_grid.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        {</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">SecondaryOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\t- CALCULATING CHANGE OF BASIS COEFFICIENTS&quot;</span>;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            fflush(stdout);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        }</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <span class="comment">//  First, we generate all of the data that will be needed to calculate the</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="comment">//  phase factor phi and the coefficients in the change of basis definition</span><span class="comment"></span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">        //////  Here we implement Eq 26     ////////////////////////////////////////////</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment"></span>        <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>* Ax = <span class="keyword">new</span> <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>[dimX*dimY];</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> kx=0; kx&lt;dimX; ++kx)</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> ky=0; ky&lt;dimY; ++ky)</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            {</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                <a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> kxPlusOnePeriodic = kx==(dimX-1) ? 0 : kx+1;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a> aTempX = utilities::linearAlgebra::DotProduct&lt;dcmplx&gt;(blochTable[kx*dimY+ky].m_blochCoefficients,</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                                blochTable[kxPlusOnePeriodic*dimY+ky].m_blochCoefficients, blochTable-&gt;m_dim);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                <span class="comment">//  Set the Berry connection to the normalized accumulated value</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                <span class="comment">//  as defined in Eq. 27:</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                Ax[kx*dimY+ky] = aTempX/abs(aTempX);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        }</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <span class="comment">//  As defined in Eq. 30:</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>* lambdaX = <span class="keyword">new</span> <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>[dimY];</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> ky=0; ky&lt;dimY; ++ky)</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            lambdaX[ky] = 1.0;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        }</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        <span class="comment">//  Generate products of Ax values</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> kx=0; kx&lt;dimX; ++kx)</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        {</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> ky=0; ky&lt;dimY; ++ky)</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                lambdaX[ky] *= Ax[kx*dimY+ky];</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            }</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        }</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> ky=0; ky&lt;dimY; ++ky)</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        {</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            lambdaX[ky] = std::pow(lambdaX[ky], 1.0/<a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>(dimX,0));</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        }</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        <span class="comment">//  aProd(kx,ky) = product_{kappa=0}^{kx-1} Ax(kappa,ky)</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>* aProd = <span class="keyword">new</span> <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>[dimX*dimY];</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> ky=0; ky&lt;dimY; ++ky)</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        {</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            aProd[ky] = 1.0;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        }</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> kx=1; kx&lt;dimX; ++kx)</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        {</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> ky=0; ky&lt;dimY; ++ky)</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            {</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                aProd[kx*dimY+ky] = Ax[(kx-1)*dimY+ky]*aProd[(kx-1)*dimY+ky];</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            }</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        }</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <span class="keyword">delete</span>[] Ax;    <span class="comment">//&lt;-- move these delete[] commands if implementing below!!</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <span class="comment">//delete[] Ay;</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <span class="comment"></span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">        ////////////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment"></span><span class="preprocessor">        #if _NOT_IMPLEMENTED_</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="preprocessor"></span>        </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        <span class="comment">//  THE GAUGE-FIXED PART OF THE WANNIER FUNCTION PERSCRIPTION IS NOT CURRENTLY IMPLEMETED</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>  lambdaY = 1.0;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> ky=0;ky&lt;dimY;++ky)</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            lambdaY *= Ay[ky];</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        lambdaY = std::pow(lambdaY, 1.0/(<span class="keywordtype">double</span>)dimY);<span class="comment"></span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">        //////  Tabulate U(ky) as defined in Eq 53      ////////////////////////////////</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment"></span>        <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>* U = <span class="keyword">new</span> <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>[dimY];</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> ky=0; ky&lt;dimY; ++ky)</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        {</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            U[ky] = 0.0;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> kx=0; kx&lt;dimX; ++kx)</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> ky=0; ky&lt;dimY; ++ky)</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                <a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> kyPlusOnePeriodic = (ky==(dimY-1) ? 0 : ky+1);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a> W = Ay[kx*dimY+ky]*aProd[kx*dimY+ky]/(aProd[kx*dimY+kyPlusOnePeriodic]*Ay[ky]);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a> Wbar = std::pow((lambdaX[ky]/lambdaX[kyPlusOnePeriodic]), (<span class="keywordtype">double</span>)kx);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                U[ky] += W/Wbar;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> ky=0; ky&lt;dimY; ++ky)</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            U[ky] /= abs(U[ky]);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        }<span class="comment"></span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">        //////      Calculate and store omega, defined in Eq 59     ////////////////////</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment"></span>        <span class="comment">//  omega = [product_ky U(ky)]^(1/dimY)  </span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a> omega = 1.0;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> ky=0;ky&lt;dimY;++ky)</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        {</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            omega *= U[ky];</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        }</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        omega = std::pow(omega, 1.0/(<span class="keywordtype">double</span>)dimY);<span class="comment"></span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">        //////  Fix the phase factors phi_y(x,ky)       ////////////////////////////////</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment"></span>        <span class="comment">//  By definition, the 0,0 phase factor is set to 0 (so exp(phase) = 1.0). </span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <span class="comment">//  The remaining factors are calculated from Eq 63.</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>* phaseFactors = <span class="keyword">new</span> <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>[dimY];</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        phaseFactors[0] = 1.0;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <span class="comment">//  Work out the remaining pre-factors from that one</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> ky=0; ky&lt;dimY-1; ++ky)</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        {</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            phaseFactors[ky+1] = phaseFactors[ky]*lambdaY*omega/(Ay[ky]*U[ky]);</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        }</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="keyword">delete</span>[] U;             <span class="comment">//&lt;-- move these delete[] commands if implemented!!</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <span class="keyword">delete</span>[] phaseFactors;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="preprocessor"></span><span class="comment">        ////////////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment"></span>        <span class="comment"></span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment">        //////      Now populate the change of basis matrix     ////////////////////</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment"></span>        <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> dim = dimX*dimY;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> x=0; x&lt;dimX; ++x)</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        {</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> ky=0; ky&lt;dimY; ++ky)</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            {</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> index1 = x*dimY+ky;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> kx=0; kx&lt;dimX; ++kx)</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                    <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">kState_t</a> ky1=0; ky1&lt;dimY; ++ky1)</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                    {</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                        <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> index2 = kx*dimY+ky1;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                        <span class="keywordflow">if</span>(ky == ky1)</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                        {</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                            M[index1*dim+index2] = exp(-2.0*<a class="code" href="i__const__def_8hpp.html#ab03128f28254e912f824640e69fc85ad">I</a>*<a class="code" href="pi__const__def_8hpp.html#a952eac791b596a61bba0a133a3bb439f">PI</a>*((<span class="keywordtype">double</span>)kx+offsetX)*(<span class="keywordtype">double</span>)x/(<span class="keywordtype">double</span>)dimX)*std::pow(lambdaX[ky], <a class="code" href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a>(kx,0))/(sqrt(dimX)*aProd[index2]);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                        }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                        {</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                            M[index1*dim+index2] = 0.0;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                        }</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                    }</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                }</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            }</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        }    <span class="comment"></span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">        //////      Clear memory that we no longer need     ////////////////////////////</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment"></span>        <span class="keyword">delete</span>[] lambdaX;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="keyword">delete</span>[] aProd;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        {</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">SecondaryOutput</a>()&lt;&lt;<span class="stringliteral">&quot; - DONE&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        }  </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    }</div>
<div class="ttc" id="namespacediagonalization_html_ab6352a2fe0c11db386c8f3e4fc09c38d"><div class="ttname"><a href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">diagonalization::iSize_t</a></div><div class="ttdeci">uint32_t iSize_t</div><div class="ttdef"><b>Definition:</b> <a href="orbital__and__state__defs_8hpp_source.html#l00043">orbital_and_state_defs.hpp:43</a></div></div>
<div class="ttc" id="namespaceutilities_html_a8bd217ae821e52872836b15f651f5d9f"><div class="ttname"><a href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a></div><div class="ttdeci">Cout cout</div><div class="ttdef"><b>Definition:</b> <a href="optical__flux__lattice__noninteracting__model_8cpp_source.html#l00035">optical_flux_lattice_noninteracting_model.cpp:35</a></div></div>
<div class="ttc" id="classutilities_1_1Cout_html_a6219e39487852117bfc3c83dd1b073b1"><div class="ttname"><a href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">utilities::Cout::SecondaryOutput</a></div><div class="ttdeci">std::ostream &amp; SecondaryOutput()</div><div class="ttdef"><b>Definition:</b> <a href="cout__tools_8hpp_source.html#l00125">cout_tools.hpp:125</a></div></div>
<div class="ttc" id="i__const__def_8hpp_html_ab03128f28254e912f824640e69fc85ad"><div class="ttname"><a href="i__const__def_8hpp.html#ab03128f28254e912f824640e69fc85ad">I</a></div><div class="ttdeci">static const std::complex&lt; double &gt; I</div><div class="ttdef"><b>Definition:</b> <a href="i__const__def_8hpp_source.html#l00014">i_const_def.hpp:14</a></div></div>
<div class="ttc" id="namespacediagonalization_html_a26ca92638e21ae8791b99ae7fa90dd4c"><div class="ttname"><a href="namespacediagonalization.html#a26ca92638e21ae8791b99ae7fa90dd4c">diagonalization::kState_t</a></div><div class="ttdeci">uint16_t kState_t</div><div class="ttdoc">Define an unsigned quantum number index type (a 16 bit unsigned int) </div><div class="ttdef"><b>Definition:</b> <a href="orbital__and__state__defs_8hpp_source.html#l00039">orbital_and_state_defs.hpp:39</a></div></div>
<div class="ttc" id="dcmplx__type__def_8hpp_html_a52196b4b274b585226e0614490f7defc"><div class="ttname"><a href="dcmplx__type__def_8hpp.html#a52196b4b274b585226e0614490f7defc">dcmplx</a></div><div class="ttdeci">std::complex&lt; double &gt; dcmplx</div><div class="ttdef"><b>Definition:</b> <a href="dcmplx__type__def_8hpp_source.html#l00014">dcmplx_type_def.hpp:14</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a0f670cb88d82d9c815e111de5e76ae3e"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">utilities::MpiWrapper::m_id</a></div><div class="ttdeci">int m_id</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8hpp_source.html#l00056">mpi_wrapper.hpp:56</a></div></div>
<div class="ttc" id="pi__const__def_8hpp_html_a952eac791b596a61bba0a133a3bb439f"><div class="ttname"><a href="pi__const__def_8hpp.html#a952eac791b596a61bba0a133a3bb439f">PI</a></div><div class="ttdeci">static const double PI</div><div class="ttdef"><b>Definition:</b> <a href="pi__const__def_8hpp_source.html#l00013">pi_const_def.hpp:13</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9166df586298af9fd39d960ce3fc89f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void diagonalization::NonInteractingOflModelGrid::PlotBandstructure </td>
          <td>(</td>
          <td class="paramtype">boost::program_options::variables_map *&#160;</td>
          <td class="paramname"><em>optionList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structutilities_1_1MpiWrapper.html">utilities::MpiWrapper</a> &amp;&#160;</td>
          <td class="paramname"><em>mpi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Plots the single particle band structure of the Hamiltonian given in e.g. eq (1) of PRL 109,265301 for a given sample of k-space. </p>
<p>Note: This function is parallelized </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">optionList</td><td>Command line arguments </td></tr>
    <tr><td class="paramname">mpi</td><td>Instance of the mpi wrapper class </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="noninteracting__ofl__model__grid_8cpp_source.html#l00288">288</a> of file <a class="el" href="noninteracting__ofl__model__grid_8cpp_source.html">noninteracting_ofl_model_grid.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a903fe4ad596cdce91e00004bc21b7e6a">MainOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tGENERATING SINGLE PARTICLE BAND STRUCTURE DATA...&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> dimX;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> dimY;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordtype">double</span> offsetX;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordtype">double</span> offsetY;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, dimX, <span class="stringliteral">&quot;x-grid&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, dimY, <span class="stringliteral">&quot;y-grid&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, offsetX, <span class="stringliteral">&quot;x-grid-shift&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, offsetY, <span class="stringliteral">&quot;x-grid-shift&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">Sync</a>(&amp;dimX, 1, 0);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">Sync</a>(&amp;dimY, 1, 0);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">Sync</a>(&amp;offsetX, 1, 0);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">Sync</a>(&amp;offsetY, 1, 0);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        NonInteractingOflModel currentModel(optionList, mpi);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">SecondaryOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tGRID: &quot;</span>&lt;&lt;dimX&lt;&lt;<span class="stringliteral">&quot; x &quot;</span>&lt;&lt;dimY&lt;&lt;std::endl;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">SecondaryOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tG_X CUT-OFF = &quot;</span>&lt;&lt;currentModel.m_xBandCutOff&lt;&lt;std::endl;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">SecondaryOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tG_Y CUT-OFF = &quot;</span>&lt;&lt;currentModel.m_yBandCutOff&lt;&lt;std::endl;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keywordflow">if</span>(2 != currentModel.m_nbrBands)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                std::cerr&lt;&lt;<span class="stringliteral">&quot;WARNING: ONLY GENERATING DATA FOR THE LOWEST TWO BANDS&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            currentModel.m_nbrBands = 2;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="comment">//  Allocate memory to store band energy values</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordtype">double</span> lowerBand[dimX*dimY];</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="keywordtype">double</span> secondBand[dimX*dimY];</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordtype">double</span> bandGap   = 0.0;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keywordtype">double</span> bandWidth = 0.0;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordtype">double</span> dummy;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        this-&gt;<a class="code" href="classdiagonalization_1_1NonInteractingOflModelGrid.html#ae77a9b7b45a0a19409a94e74a683daf1">CalculateBandstructure</a>(lowerBand, secondBand, bandWidth, bandGap, <span class="keyword">true</span>, &amp;dummy, </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                                     <span class="keyword">false</span>, dimX, dimY, offsetX, offsetY, &amp;currentModel, mpi);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            std::stringstream dataFileName;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            dataFileName.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            std::string outPath;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, outPath, <span class="stringliteral">&quot;out-path&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            dataFileName &lt;&lt; optionList &lt;&lt; <span class="stringliteral">&quot;/band_structure_kx_&quot;</span> &lt;&lt; dimX &lt;&lt; <span class="stringliteral">&quot;_ky_&quot;</span> &lt;&lt; dimY;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <span class="keywordtype">bool</span> useSql;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, useSql, <span class="stringliteral">&quot;use-sql&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> sqlId;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, sqlId, <span class="stringliteral">&quot;sql-id&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="keywordflow">if</span>(useSql)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                dataFileName &lt;&lt; <span class="stringliteral">&quot;_id_&quot;</span> &lt;&lt; sqlId;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            dataFileName &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            std::ofstream f_tmp;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            f_tmp.open(dataFileName.str().c_str(), std::ios::out);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keywordtype">double</span>* p_lower = lowerBand;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            <span class="keywordtype">double</span>* p_second = secondBand;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <a class="code" href="classutilities_1_1LatticeVector2D.html">utilities::LatticeVector2D&lt;double&gt;</a> kVector(offsetX, offsetY);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <a class="code" href="classutilities_1_1LatticeVector2D.html">utilities::LatticeVector2D&lt;double&gt;</a> increment1(<a class="code" href="namespacediagonalization_1_1reciprocalLattice.html#aa61393cdc02028a0375aa5071f06cb86">reciprocalLattice::G1</a>, (<span class="keywordtype">double</span>)1/dimX);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <a class="code" href="classutilities_1_1LatticeVector2D.html">utilities::LatticeVector2D&lt;double&gt;</a> increment2(<a class="code" href="namespacediagonalization_1_1reciprocalLattice.html#a09fc4b1306501141a270fa90bd159fe1">reciprocalLattice::G2</a>, (<span class="keywordtype">double</span>)1/dimY); </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            f_tmp&lt;&lt;dimX&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            f_tmp&lt;&lt;dimY&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            f_tmp&lt;&lt;std::setw(15)&lt;&lt;std::left&lt;&lt;<span class="stringliteral">&quot;kx values&quot;</span>&lt;&lt;<span class="stringliteral">&quot;\t&quot;</span>&lt;&lt;std::setw(15)&lt;&lt;std::left&lt;&lt;<span class="stringliteral">&quot;ky values&quot;</span>&lt;&lt;<span class="stringliteral">&quot;\t&quot;</span>&lt;&lt;std::setw(20)&lt;&lt;std::left&lt;&lt;<span class="stringliteral">&quot;0th band energy&quot;</span>&lt;&lt;<span class="stringliteral">&quot;\t&quot;</span>&lt;&lt;std::setw(20)&lt;&lt;std::left&lt;&lt;<span class="stringliteral">&quot;1st band energy&quot;</span>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> x=0; x&lt;dimX; ++x, kVector-=<a class="code" href="namespacediagonalization_1_1reciprocalLattice.html#a09fc4b1306501141a270fa90bd159fe1">reciprocalLattice::G2</a>, kVector += increment1)</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> y=0; y&lt;dimY; ++y, ++p_lower, ++p_second, kVector += increment2)</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                    f_tmp&lt;&lt;std::setw(15)&lt;&lt;std::setprecision(10)&lt;&lt;std::left&lt;&lt;kVector.GetKx()&lt;&lt;<span class="stringliteral">&quot;\t&quot;</span>&lt;&lt;std::setw(15)&lt;&lt;std::left&lt;&lt;kVector.GetKy()&lt;&lt;<span class="stringliteral">&quot;\t&quot;</span>&lt;&lt;std::setw(20)&lt;&lt;std::left&lt;&lt;std::setprecision(15)&lt;&lt;*(p_lower)&lt;&lt;<span class="stringliteral">&quot;\t&quot;</span>&lt;&lt;std::setw(20)&lt;&lt;std::left&lt;&lt;std::setprecision(15)&lt;&lt;*(p_second)&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            f_tmp.close();</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">SecondaryOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tData output to file &quot;</span>&lt;&lt;dataFileName.str()&lt;&lt;std::endl;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <span class="keywordtype">bool</span> plotBandstructure;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, plotBandstructure, <span class="stringliteral">&quot;plot-bandstructure&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            <span class="keywordflow">if</span>(plotBandstructure)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a2d11fc59d54199d37f4627dc645dff93">AdditionalInfo</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tMAKING PLOT...&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                std::stringstream plotFileName;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                plotFileName.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                std::string outPath;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, outPath, <span class="stringliteral">&quot;out-path&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                plotFileName&lt;&lt;outPath&lt;&lt;<span class="stringliteral">&quot;/band_structure_kx_&quot;</span>&lt;&lt;dimX&lt;&lt;<span class="stringliteral">&quot;_ky_&quot;</span>&lt;&lt;dimY&lt;&lt;<span class="stringliteral">&quot;.pdf&quot;</span>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                std::stringstream pythonScript;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                pythonScript.str();</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                pythonScript&lt;&lt;<span class="stringliteral">&quot;#! //usr//bin//env python&quot;</span>&lt;&lt;_PYTHON_VERSION_&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                <span class="stringliteral">&quot;import matplotlib                              \n&quot;</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                <span class="stringliteral">&quot;import numpy as np                             \n&quot;</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                <span class="stringliteral">&quot;import math                                    \n&quot;</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                <span class="stringliteral">&quot;matplotlib.use(&#39;Agg&#39;)                        \n\n&quot;</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                <span class="stringliteral">&quot;import matplotlib.pyplot as plt              \n\n&quot;</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                <span class="stringliteral">&quot;from mpl_toolkits.mplot3d import Axes3D      \n\n&quot;</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                <span class="stringliteral">&quot;xData = []                                     \n&quot;</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                <span class="stringliteral">&quot;yData = []                                     \n&quot;</span>   </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                <span class="stringliteral">&quot;lowerBand = []                                 \n&quot;</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                <span class="stringliteral">&quot;secondBand = []                              \n\n&quot;</span>  </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                <span class="stringliteral">&quot;fin=open(\&quot;&quot;</span>&lt;&lt;dataFileName.str()&lt;&lt;<span class="stringliteral">&quot;\&quot;)       \n\n&quot;</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                <span class="stringliteral">&quot;fin.readline()                                 \n&quot;</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                <span class="stringliteral">&quot;fin.readline()                                 \n&quot;</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                <span class="stringliteral">&quot;fin.readline()                                 \n&quot;</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                <span class="stringliteral">&quot;for line in fin:                               \n&quot;</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                <span class="stringliteral">&quot;    line = line.split()                        \n&quot;</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                <span class="stringliteral">&quot;    xData.append(float(line[0]))               \n&quot;</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                <span class="stringliteral">&quot;    yData.append(float(line[1]))               \n&quot;</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                <span class="stringliteral">&quot;    lowerBand.append(float(line[2]))           \n&quot;</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                <span class="stringliteral">&quot;    secondBand.append(float(line[3]))          \n&quot;</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <span class="stringliteral">&quot;fin.close()                                  \n\n&quot;</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                <span class="stringliteral">&quot;fig = plt.figure()                           \n\n&quot;</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                <span class="stringliteral">&quot;ax = fig.gca(projection=&#39;3d&#39;)                \n\n&quot;</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                <span class="stringliteral">&quot;ax.plot_trisurf(xData,yData,lowerBand)         \n&quot;</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                <span class="stringliteral">&quot;ax.plot_trisurf(xData,yData,secondBand,color=&#39;r&#39;)\n&quot;</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                <span class="stringliteral">&quot;plt.title(\&quot;Band gap: &quot;</span>&lt;&lt;bandGap&lt;&lt;<span class="stringliteral">&quot; ; Band width: &quot;</span>&lt;&lt;bandWidth&lt;&lt;<span class="stringliteral">&quot;\&quot;)\n&quot;</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                <span class="stringliteral">&quot;plt.savefig(\&quot;&quot;</span>&lt;&lt;plotFileName.str()&lt;&lt;<span class="stringliteral">&quot;\&quot;) \n&quot;</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                <span class="stringliteral">&quot;plt.close() \n&quot;</span>;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                <a class="code" href="classutilities_1_1Script.html">utilities::Script</a> myScript;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                myScript.<a class="code" href="classutilities_1_1Script.html#af021d99ea6176a02e4affcead01fb4d2">SetScript</a>(pythonScript.str());</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                myScript.<a class="code" href="classutilities_1_1Script.html#acdd7c08fa88f29ac9d735f6be90fcab2">Execute</a>();</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a903fe4ad596cdce91e00004bc21b7e6a">MainOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\t...PLOT SUCESSFULLY GENERATED&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a903fe4ad596cdce91e00004bc21b7e6a">MainOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tFind it at &quot;</span>&lt;&lt;plotFileName.str()&lt;&lt;std::endl;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    }</div>
<div class="ttc" id="namespacediagonalization_html_ab6352a2fe0c11db386c8f3e4fc09c38d"><div class="ttname"><a href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">diagonalization::iSize_t</a></div><div class="ttdeci">uint32_t iSize_t</div><div class="ttdef"><b>Definition:</b> <a href="orbital__and__state__defs_8hpp_source.html#l00043">orbital_and_state_defs.hpp:43</a></div></div>
<div class="ttc" id="classdiagonalization_1_1NonInteractingOflModelGrid_html_ae77a9b7b45a0a19409a94e74a683daf1"><div class="ttname"><a href="classdiagonalization_1_1NonInteractingOflModelGrid.html#ae77a9b7b45a0a19409a94e74a683daf1">diagonalization::NonInteractingOflModelGrid::CalculateBandstructure</a></div><div class="ttdeci">void CalculateBandstructure(double *lowerBand, double *secondBand, double &amp;bandWidth, double &amp;bandGap, const bool getEnergyData, double *magnetization, const bool getMagnetizationData, const iSize_t dimX, const iSize_t dimY, const double offsetX, const double offsetY, NonInteractingOflModel *ham, utilities::MpiWrapper &amp;mpi)</div><div class="ttdef"><b>Definition:</b> <a href="noninteracting__ofl__model__grid_8cpp_source.html#l00160">noninteracting_ofl_model_grid.cpp:160</a></div></div>
<div class="ttc" id="namespacediagonalization_1_1reciprocalLattice_html_a09fc4b1306501141a270fa90bd159fe1"><div class="ttname"><a href="namespacediagonalization_1_1reciprocalLattice.html#a09fc4b1306501141a270fa90bd159fe1">diagonalization::reciprocalLattice::G2</a></div><div class="ttdeci">static const utilities::LatticeVector2D&lt; double &gt; G2(0.866025403784438646763723170753,-1.5)</div></div>
<div class="ttc" id="classutilities_1_1Script_html_af021d99ea6176a02e4affcead01fb4d2"><div class="ttname"><a href="classutilities_1_1Script.html#af021d99ea6176a02e4affcead01fb4d2">utilities::Script::SetScript</a></div><div class="ttdeci">void SetScript(const std::string newText)</div><div class="ttdef"><b>Definition:</b> <a href="run__script_8hpp_source.html#l00099">run_script.hpp:99</a></div></div>
<div class="ttc" id="classutilities_1_1Script_html_acdd7c08fa88f29ac9d735f6be90fcab2"><div class="ttname"><a href="classutilities_1_1Script.html#acdd7c08fa88f29ac9d735f6be90fcab2">utilities::Script::Execute</a></div><div class="ttdeci">void Execute() const </div><div class="ttdef"><b>Definition:</b> <a href="run__script_8hpp_source.html#l00113">run_script.hpp:113</a></div></div>
<div class="ttc" id="classutilities_1_1Cout_html_a903fe4ad596cdce91e00004bc21b7e6a"><div class="ttname"><a href="classutilities_1_1Cout.html#a903fe4ad596cdce91e00004bc21b7e6a">utilities::Cout::MainOutput</a></div><div class="ttdeci">std::ostream &amp; MainOutput()</div><div class="ttdef"><b>Definition:</b> <a href="cout__tools_8hpp_source.html#l00118">cout_tools.hpp:118</a></div></div>
<div class="ttc" id="namespaceutilities_html_a8bd217ae821e52872836b15f651f5d9f"><div class="ttname"><a href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a></div><div class="ttdeci">Cout cout</div><div class="ttdef"><b>Definition:</b> <a href="optical__flux__lattice__noninteracting__model_8cpp_source.html#l00035">optical_flux_lattice_noninteracting_model.cpp:35</a></div></div>
<div class="ttc" id="namespaceutilities_html_a0a4e0749cf92abf92f2b0290ae0639a6"><div class="ttname"><a href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">utilities::GetOption</a></div><div class="ttdeci">void GetOption(boost::program_options::variables_map *variables_map, T &amp;variable, const std::string name, const std::string location)</div><div class="ttdef"><b>Definition:</b> <a href="program__options__wrapper_8hpp_source.html#l00043">program_options_wrapper.hpp:43</a></div></div>
<div class="ttc" id="classutilities_1_1Script_html"><div class="ttname"><a href="classutilities_1_1Script.html">utilities::Script</a></div><div class="ttdoc">A class to convert a given string to a text file and execute it as a script. </div><div class="ttdef"><b>Definition:</b> <a href="run__script_8hpp_source.html#l00050">run_script.hpp:50</a></div></div>
<div class="ttc" id="program__options__wrapper_8hpp_html_a546a3df1472df59c883c923d5f59663a"><div class="ttname"><a href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a></div><div class="ttdeci">#define _AT_</div><div class="ttdef"><b>Definition:</b> <a href="program__options__wrapper_8hpp_source.html#l00031">program_options_wrapper.hpp:31</a></div></div>
<div class="ttc" id="classutilities_1_1Cout_html_a6219e39487852117bfc3c83dd1b073b1"><div class="ttname"><a href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">utilities::Cout::SecondaryOutput</a></div><div class="ttdeci">std::ostream &amp; SecondaryOutput()</div><div class="ttdef"><b>Definition:</b> <a href="cout__tools_8hpp_source.html#l00125">cout_tools.hpp:125</a></div></div>
<div class="ttc" id="classutilities_1_1Cout_html_a2d11fc59d54199d37f4627dc645dff93"><div class="ttname"><a href="classutilities_1_1Cout.html#a2d11fc59d54199d37f4627dc645dff93">utilities::Cout::AdditionalInfo</a></div><div class="ttdeci">std::ostream &amp; AdditionalInfo()</div><div class="ttdef"><b>Definition:</b> <a href="cout__tools_8hpp_source.html#l00132">cout_tools.hpp:132</a></div></div>
<div class="ttc" id="namespacediagonalization_1_1reciprocalLattice_html_aa61393cdc02028a0375aa5071f06cb86"><div class="ttname"><a href="namespacediagonalization_1_1reciprocalLattice.html#aa61393cdc02028a0375aa5071f06cb86">diagonalization::reciprocalLattice::G1</a></div><div class="ttdeci">static const utilities::LatticeVector2D&lt; double &gt; G1(-0.866025403784438646763723170753,-1.5)</div></div>
<div class="ttc" id="classutilities_1_1LatticeVector2D_html"><div class="ttname"><a href="classutilities_1_1LatticeVector2D.html">utilities::LatticeVector2D&lt; double &gt;</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a0f670cb88d82d9c815e111de5e76ae3e"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">utilities::MpiWrapper::m_id</a></div><div class="ttdeci">int m_id</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8hpp_source.html#l00056">mpi_wrapper.hpp:56</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_ab7c5634cdbed7e4436b54b9ef619f85b"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">utilities::MpiWrapper::Sync</a></div><div class="ttdeci">void Sync(std::string &amp;buffer, int syncNode) const </div><div class="ttdoc">A function to MPI synchronize a string. </div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8cpp_source.html#l00345">mpi_wrapper.cpp:345</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a58382f228c639a512e65bfbdbb3586c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void diagonalization::NonInteractingOflModelGrid::PlotBandWidth </td>
          <td>(</td>
          <td class="paramtype">boost::program_options::variables_map *&#160;</td>
          <td class="paramname"><em>optionList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structutilities_1_1MpiWrapper.html">utilities::MpiWrapper</a> &amp;&#160;</td>
          <td class="paramname"><em>mpi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Make a plot of the band width as a function of the lattice depth V0 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">optionList</td><td>Command line arguments </td></tr>
    <tr><td class="paramname">mpi</td><td>Instance of the mpi wrapper class </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="noninteracting__ofl__model__grid_8cpp_source.html#l00424">424</a> of file <a class="el" href="noninteracting__ofl__model__grid_8cpp_source.html">noninteracting_ofl_model_grid.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a903fe4ad596cdce91e00004bc21b7e6a">MainOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tGENERATING BAND WIDTH AND GAP VS V0/E_R DATA...&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> dimX;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> dimY;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keywordtype">double</span> offsetX;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="keywordtype">double</span> offsetY;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        std::stringstream dataFileName;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, dimX, <span class="stringliteral">&quot;x-grid&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, dimY, <span class="stringliteral">&quot;y-grid&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="keywordtype">bool</span> useSql;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, useSql, <span class="stringliteral">&quot;use-sql&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            std::string outPath;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, outPath, <span class="stringliteral">&quot;out-path&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <span class="keywordflow">if</span>(useSql)</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                std::stringstream fileName;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                fileName.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                <span class="comment">//  If sql option is set, then look for model data in an sqlite file</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                std::string inPath;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                std::string sqlName;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                std::string sqlTableName;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, inPath, <span class="stringliteral">&quot;in-path&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, sqlName, <span class="stringliteral">&quot;sql-name&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, sqlTableName, <span class="stringliteral">&quot;sql-table-name&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                fileName &lt;&lt; inPath &lt;&lt; sqlName;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                <a class="code" href="classutilities_1_1Sqlite.html">utilities::Sqlite</a> sql(fileName.str(), <a class="code" href="namespacesql.html#aceddbcdc663a2214f73b83c6abec9d78a09fa1bb3cb667039740ba5a81250757a">sql::_READ_EXISTING_</a>);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                <span class="keywordflow">if</span>(!mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a7ffe7ed2049a6b7feb5778886a0d522e">m_exitFlag</a>)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                    mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a7ffe7ed2049a6b7feb5778886a0d522e">m_exitFlag</a> = !sql.IsOpen();</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> sqlId;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, sqlId, <span class="stringliteral">&quot;sql-id&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                <a class="code" href="classutilities_1_1SqliteRow.html">utilities::SqliteRow</a> sqlRow = sql.RetrieveIdFromTable(sqlTableName, sqlId); </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                <span class="keywordflow">if</span>(sqlRow.<a class="code" href="classutilities_1_1SqliteRow.html#a2886edefb84a5c8d6e971983a312fc1a">GetLength</a>() == 0)</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                    mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a7ffe7ed2049a6b7feb5778886a0d522e">m_exitFlag</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                <span class="comment">//  Check if the calculated has already been completed (as recorded by</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                <span class="comment">//  the &quot;completed&quot; column in the SQL table</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                <span class="keywordtype">int</span> isAlreadyCalculated = 0;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a7ffe7ed2049a6b7feb5778886a0d522e">m_exitFlag</a> = sqlRow.<a class="code" href="classutilities_1_1SqliteRow.html#ae3e4c53d5c9fbc15c3b68b962c5c60cd">GetValue</a>(<span class="stringliteral">&quot;Completed&quot;</span>, isAlreadyCalculated);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                <span class="keywordflow">if</span>(isAlreadyCalculated)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                    std::cerr&lt;&lt;<span class="stringliteral">&quot;Calculated already completed (according to SQL table). SKIPPING&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                    mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a7ffe7ed2049a6b7feb5778886a0d522e">m_exitFlag</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                }</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                std::string outFileName;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a7ffe7ed2049a6b7feb5778886a0d522e">m_exitFlag</a> = sqlRow.<a class="code" href="classutilities_1_1SqliteRow.html#ae3e4c53d5c9fbc15c3b68b962c5c60cd">GetValue</a>(<span class="stringliteral">&quot;OutFileName&quot;</span>,outFileName);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a7ffe7ed2049a6b7feb5778886a0d522e">m_exitFlag</a> = sqlRow.<a class="code" href="classutilities_1_1SqliteRow.html#ae3e4c53d5c9fbc15c3b68b962c5c60cd">GetValue</a>(<span class="stringliteral">&quot;OffsetX&quot;</span>,offsetX);    </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a7ffe7ed2049a6b7feb5778886a0d522e">m_exitFlag</a> = sqlRow.<a class="code" href="classutilities_1_1SqliteRow.html#ae3e4c53d5c9fbc15c3b68b962c5c60cd">GetValue</a>(<span class="stringliteral">&quot;OffsetY&quot;</span>,offsetY);    </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                dataFileName.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                dataFileName &lt;&lt; outPath &lt;&lt; outFileName &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, offsetX, <span class="stringliteral">&quot;x-grid-shift&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, offsetY, <span class="stringliteral">&quot;y-grid-shift&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                dataFileName.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                dataFileName &lt;&lt; outPath &lt;&lt; <span class="stringliteral">&quot;/band_width_kx_&quot;</span> &lt;&lt; dimX &lt;&lt; <span class="stringliteral">&quot;_ky_&quot;</span> &lt;&lt; dimY &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a34ac9d5bfd351da9b7696b5652eb95d5">ExitFlagTest</a>();</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">Sync</a>(&amp;dimX, 1, 0);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">Sync</a>(&amp;dimY, 1, 0);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">Sync</a>(&amp;offsetX, 1, 0);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">Sync</a>(&amp;offsetY, 1, 0);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        NonInteractingOflModel currentModel(optionList, mpi);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">SecondaryOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tGRID: &quot;</span>&lt;&lt;dimX&lt;&lt;<span class="stringliteral">&quot; x &quot;</span>&lt;&lt;dimY&lt;&lt;std::endl;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">SecondaryOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tG_X CUT-OFF = &quot;</span>&lt;&lt;currentModel.m_xBandCutOff&lt;&lt;std::endl;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">SecondaryOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tG_Y CUT-OFF = &quot;</span>&lt;&lt;currentModel.m_yBandCutOff&lt;&lt;std::endl;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="comment">//  Allocate memory to store band energy values</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keywordtype">double</span> lowerBand[dimX*dimY];</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="keywordtype">double</span> secondBand[dimX*dimY];</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> V0Max = 5.0;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> V0grid = 0.1;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> gridMax = floor(V0Max/V0grid);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="comment">//  Update the V0 parameter to the first V0 value</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        currentModel.m_params.m_V0 = V0grid;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="comment">//  Output the plot data as a .dat file</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        std::ofstream f_tmp;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            f_tmp.open(dataFileName.str().c_str(), std::ios::out);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            f_tmp&lt;&lt;std::setw(15)&lt;&lt;std::left&lt;&lt;<span class="stringliteral">&quot;V0/E_R values&quot;</span>&lt;&lt;<span class="stringliteral">&quot;\t&quot;</span>&lt;&lt;std::setw(15)&lt;&lt;std::left&lt;&lt;<span class="stringliteral">&quot;band width/E_R&quot;</span>&lt;&lt;<span class="stringliteral">&quot;\t&quot;</span>&lt;&lt;std::setw(15)&lt;&lt;std::left&lt;&lt;<span class="stringliteral">&quot;band gap/E_R&quot;</span>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="comment">//  Generate the band structure for each V0 value</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> v=0; v&lt;=gridMax; ++v)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">SecondaryOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tV0 = &quot;</span>&lt;&lt;currentModel.m_params.m_V0&lt;&lt;<span class="stringliteral">&quot; (going up to &quot;</span>&lt;&lt;V0Max+V0grid&lt;&lt;<span class="stringliteral">&quot;)&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            }</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            <span class="keywordtype">double</span> bandGap;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <span class="keywordtype">double</span> bandWidth;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            <span class="keywordtype">double</span> dummy;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            this-&gt;<a class="code" href="classdiagonalization_1_1NonInteractingOflModelGrid.html#ae77a9b7b45a0a19409a94e74a683daf1">CalculateBandstructure</a>(lowerBand, secondBand, bandWidth, bandGap, <span class="keyword">true</span>, &amp;dummy, </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                                         <span class="keyword">false</span>, dimX, dimY, offsetX, offsetY, &amp;currentModel, mpi);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                f_tmp&lt;&lt;std::setw(15)&lt;&lt;std::left&lt;&lt;currentModel.m_params.m_V0/currentModel.GetRecoilEnergy()&lt;&lt;<span class="stringliteral">&quot;\t&quot;</span>&lt;&lt;std::setw(15)&lt;&lt;std::left&lt;&lt;bandWidth/currentModel.GetRecoilEnergy()&lt;&lt;<span class="stringliteral">&quot;\t&quot;</span>&lt;&lt;std::setw(15)&lt;&lt;std::left&lt;&lt;bandGap/currentModel.GetRecoilEnergy()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            currentModel.m_params.m_V0 += V0grid;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            f_tmp.close();</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">SecondaryOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tData output to file &quot;</span>&lt;&lt;dataFileName.str()&lt;&lt;std::endl;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            <span class="keywordtype">bool</span> plotBandWidth;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, plotBandWidth, <span class="stringliteral">&quot;plot-band-width&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            std::string outPath;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, outPath, <span class="stringliteral">&quot;out-path&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            <span class="keywordflow">if</span>(plotBandWidth)</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">SecondaryOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tMAKING PLOT...&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                std::stringstream plotFileName;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                plotFileName.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                plotFileName&lt;&lt;outPath&lt;&lt;<span class="stringliteral">&quot;/band_width_kx_&quot;</span>&lt;&lt;dimX&lt;&lt;<span class="stringliteral">&quot;_ky_&quot;</span>&lt;&lt;dimY&lt;&lt;<span class="stringliteral">&quot;.pdf&quot;</span>;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                std::stringstream pythonScript;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                pythonScript.str();</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                pythonScript&lt;&lt;<span class="stringliteral">&quot;#! //usr//bin//env python&quot;</span>&lt;&lt;_PYTHON_VERSION_&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                <span class="stringliteral">&quot;import matplotlib                              \n&quot;</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                <span class="stringliteral">&quot;import numpy as np                             \n&quot;</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                <span class="stringliteral">&quot;import math                                    \n&quot;</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                <span class="stringliteral">&quot;matplotlib.use(&#39;Agg&#39;)                        \n\n&quot;</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                <span class="stringliteral">&quot;import matplotlib.pyplot as plt              \n\n&quot;</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                <span class="stringliteral">&quot;from mpl_toolkits.mplot3d import Axes3D      \n\n&quot;</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                <span class="stringliteral">&quot;xData = []                                     \n&quot;</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                <span class="stringliteral">&quot;bandWidth = []                                 \n&quot;</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                <span class="stringliteral">&quot;bandGap = []                                 \n\n&quot;</span>  </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                <span class="stringliteral">&quot;fin=open(\&quot;&quot;</span>&lt;&lt;dataFileName.str()&lt;&lt;<span class="stringliteral">&quot;\&quot;)       \n\n&quot;</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                <span class="stringliteral">&quot;fin.readline()                                 \n&quot;</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                <span class="stringliteral">&quot;for line in fin:                               \n&quot;</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                <span class="stringliteral">&quot;    line = line.split()                        \n&quot;</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                <span class="stringliteral">&quot;    xData.append(float(line[0]))               \n&quot;</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                <span class="stringliteral">&quot;    bandWidth.append(float(line[1]))           \n&quot;</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                <span class="stringliteral">&quot;    bandGap.append(float(line[2]))             \n&quot;</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                <span class="stringliteral">&quot;fin.close()                                  \n\n&quot;</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                <span class="stringliteral">&quot;p1, = plt.plot(xData,bandWidth)                \n&quot;</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                <span class="stringliteral">&quot;p2, = plt.plot(xData,bandGap,c=&#39;r&#39;)            \n&quot;</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                <span class="stringliteral">&quot;plt.title(\&quot;Band width and gap vs $V_0/E_R$\&quot;) \n&quot;</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                <span class="stringliteral">&quot;plt.legend([p1,p2],[\&quot;Band Width/E_R\&quot;,\&quot;Band Gap/E_R\&quot;])\n&quot;</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                <span class="stringliteral">&quot;plt.savefig(\&quot;&quot;</span>&lt;&lt;plotFileName.str()&lt;&lt;<span class="stringliteral">&quot;\&quot;) \n&quot;</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                <span class="stringliteral">&quot;plt.close() \n&quot;</span>;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                <a class="code" href="classutilities_1_1Script.html">utilities::Script</a> myScript;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                myScript.<a class="code" href="classutilities_1_1Script.html#af021d99ea6176a02e4affcead01fb4d2">SetScript</a>(pythonScript.str());</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                myScript.<a class="code" href="classutilities_1_1Script.html#acdd7c08fa88f29ac9d735f6be90fcab2">Execute</a>();</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a903fe4ad596cdce91e00004bc21b7e6a">MainOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\t...PLOT SUCESSFULLY GENERATED&quot;</span>&lt;&lt;std::endl;   </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a903fe4ad596cdce91e00004bc21b7e6a">MainOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tFind it at &quot;</span>&lt;&lt;plotFileName.str()&lt;&lt;std::endl;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            }</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        }</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            <span class="keywordtype">bool</span> useSql;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, useSql, <span class="stringliteral">&quot;use-sql&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            std::string inPath;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, inPath, <span class="stringliteral">&quot;in-path&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            <span class="keywordflow">if</span>(useSql)</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                std::stringstream fileName;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                fileName.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                <span class="comment">//  If sql option is set, then look for model data in an sqlite file</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                std::string sqlName;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, sqlName, <span class="stringliteral">&quot;sql-name&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                fileName &lt;&lt; inPath &lt;&lt; sqlName;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                std::string sqlTableName;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> sqlId;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, sqlTableName, <span class="stringliteral">&quot;sql-table-name&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, sqlId, <span class="stringliteral">&quot;sql-id&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                <a class="code" href="classutilities_1_1Sqlite.html">utilities::Sqlite</a> sql(fileName.str(), <a class="code" href="namespacesql.html#aceddbcdc663a2214f73b83c6abec9d78ac528df961b488096f159cb0243365fec">sql::_EDIT_EXISTING_</a>);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                    <a class="code" href="classutilities_1_1SqliteVariable.html">utilities::SqliteVariable</a> var;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                    var.<a class="code" href="classutilities_1_1SqliteVariable.html#aa8c430dbba489361143ef27983c91313">SetValues</a>(<span class="stringliteral">&quot;Completed&quot;</span>, (<span class="keywordtype">int</span>)1);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                    sql.UpdateTableEntry(sqlTableName, sqlId, var);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                }</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                <span class="comment">//  Record the PBS job id, if known</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                <span class="keywordflow">if</span>(getenv(<span class="stringliteral">&quot;PBS_JOBID&quot;</span>)!=NULL)</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                    <a class="code" href="classutilities_1_1SqliteVariable.html">utilities::SqliteVariable</a> var;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                    var.<a class="code" href="classutilities_1_1SqliteVariable.html#aa8c430dbba489361143ef27983c91313">SetValues</a>(<span class="stringliteral">&quot;jobId&quot;</span>,(<span class="keywordtype">int</span>)atoi(getenv(<span class="stringliteral">&quot;PBS_JOBID&quot;</span>)));</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                    sql.UpdateTableEntry(sqlTableName, sqlId, var);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                <span class="comment">//  Record the SLURM job id, if known</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                <span class="keywordflow">if</span>(getenv(<span class="stringliteral">&quot;SLURM_JOB_ID&quot;</span>)!=NULL)</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                    <a class="code" href="classutilities_1_1SqliteVariable.html">utilities::SqliteVariable</a> var;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                    var.<a class="code" href="classutilities_1_1SqliteVariable.html#aa8c430dbba489361143ef27983c91313">SetValues</a>(<span class="stringliteral">&quot;jobId&quot;</span>, (<span class="keywordtype">int</span>)atoi(getenv(<span class="stringliteral">&quot;SLURM_JOB_ID&quot;</span>)));</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                    sql.UpdateTableEntry(sqlTableName, sqlId, var);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                <span class="comment">//  Update the text copy of the table</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                sql.CopyTableToTextFile(sqlTableName, fileName.str());</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            }</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        }</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    }</div>
<div class="ttc" id="classutilities_1_1SqliteRow_html"><div class="ttname"><a href="classutilities_1_1SqliteRow.html">utilities::SqliteRow</a></div><div class="ttdoc">A class to contain is list of SqliteVariables to form a single row in an Sqlite table. </div><div class="ttdef"><b>Definition:</b> <a href="sqlite__wrapper_8hpp_source.html#l00119">sqlite_wrapper.hpp:119</a></div></div>
<div class="ttc" id="namespacediagonalization_html_ab6352a2fe0c11db386c8f3e4fc09c38d"><div class="ttname"><a href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">diagonalization::iSize_t</a></div><div class="ttdeci">uint32_t iSize_t</div><div class="ttdef"><b>Definition:</b> <a href="orbital__and__state__defs_8hpp_source.html#l00043">orbital_and_state_defs.hpp:43</a></div></div>
<div class="ttc" id="classutilities_1_1SqliteRow_html_ae3e4c53d5c9fbc15c3b68b962c5c60cd"><div class="ttname"><a href="classutilities_1_1SqliteRow.html#ae3e4c53d5c9fbc15c3b68b962c5c60cd">utilities::SqliteRow::GetValue</a></div><div class="ttdeci">bool GetValue(const std::string name, T &amp;value)</div><div class="ttdef"><b>Definition:</b> <a href="sqlite__wrapper_8hpp_source.html#l00173">sqlite_wrapper.hpp:173</a></div></div>
<div class="ttc" id="classdiagonalization_1_1NonInteractingOflModelGrid_html_ae77a9b7b45a0a19409a94e74a683daf1"><div class="ttname"><a href="classdiagonalization_1_1NonInteractingOflModelGrid.html#ae77a9b7b45a0a19409a94e74a683daf1">diagonalization::NonInteractingOflModelGrid::CalculateBandstructure</a></div><div class="ttdeci">void CalculateBandstructure(double *lowerBand, double *secondBand, double &amp;bandWidth, double &amp;bandGap, const bool getEnergyData, double *magnetization, const bool getMagnetizationData, const iSize_t dimX, const iSize_t dimY, const double offsetX, const double offsetY, NonInteractingOflModel *ham, utilities::MpiWrapper &amp;mpi)</div><div class="ttdef"><b>Definition:</b> <a href="noninteracting__ofl__model__grid_8cpp_source.html#l00160">noninteracting_ofl_model_grid.cpp:160</a></div></div>
<div class="ttc" id="classutilities_1_1Script_html_af021d99ea6176a02e4affcead01fb4d2"><div class="ttname"><a href="classutilities_1_1Script.html#af021d99ea6176a02e4affcead01fb4d2">utilities::Script::SetScript</a></div><div class="ttdeci">void SetScript(const std::string newText)</div><div class="ttdef"><b>Definition:</b> <a href="run__script_8hpp_source.html#l00099">run_script.hpp:99</a></div></div>
<div class="ttc" id="classutilities_1_1Script_html_acdd7c08fa88f29ac9d735f6be90fcab2"><div class="ttname"><a href="classutilities_1_1Script.html#acdd7c08fa88f29ac9d735f6be90fcab2">utilities::Script::Execute</a></div><div class="ttdeci">void Execute() const </div><div class="ttdef"><b>Definition:</b> <a href="run__script_8hpp_source.html#l00113">run_script.hpp:113</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a34ac9d5bfd351da9b7696b5652eb95d5"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a34ac9d5bfd351da9b7696b5652eb95d5">utilities::MpiWrapper::ExitFlagTest</a></div><div class="ttdeci">void ExitFlagTest()</div><div class="ttdoc">If the exitflag is set to true on the master node, then call Terminate. </div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8cpp_source.html#l00327">mpi_wrapper.cpp:327</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a7ffe7ed2049a6b7feb5778886a0d522e"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a7ffe7ed2049a6b7feb5778886a0d522e">utilities::MpiWrapper::m_exitFlag</a></div><div class="ttdeci">bool m_exitFlag</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8hpp_source.html#l00067">mpi_wrapper.hpp:67</a></div></div>
<div class="ttc" id="classutilities_1_1Cout_html_a903fe4ad596cdce91e00004bc21b7e6a"><div class="ttname"><a href="classutilities_1_1Cout.html#a903fe4ad596cdce91e00004bc21b7e6a">utilities::Cout::MainOutput</a></div><div class="ttdeci">std::ostream &amp; MainOutput()</div><div class="ttdef"><b>Definition:</b> <a href="cout__tools_8hpp_source.html#l00118">cout_tools.hpp:118</a></div></div>
<div class="ttc" id="namespaceutilities_html_a8bd217ae821e52872836b15f651f5d9f"><div class="ttname"><a href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a></div><div class="ttdeci">Cout cout</div><div class="ttdef"><b>Definition:</b> <a href="optical__flux__lattice__noninteracting__model_8cpp_source.html#l00035">optical_flux_lattice_noninteracting_model.cpp:35</a></div></div>
<div class="ttc" id="namespaceutilities_html_a0a4e0749cf92abf92f2b0290ae0639a6"><div class="ttname"><a href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">utilities::GetOption</a></div><div class="ttdeci">void GetOption(boost::program_options::variables_map *variables_map, T &amp;variable, const std::string name, const std::string location)</div><div class="ttdef"><b>Definition:</b> <a href="program__options__wrapper_8hpp_source.html#l00043">program_options_wrapper.hpp:43</a></div></div>
<div class="ttc" id="classutilities_1_1Script_html"><div class="ttname"><a href="classutilities_1_1Script.html">utilities::Script</a></div><div class="ttdoc">A class to convert a given string to a text file and execute it as a script. </div><div class="ttdef"><b>Definition:</b> <a href="run__script_8hpp_source.html#l00050">run_script.hpp:50</a></div></div>
<div class="ttc" id="program__options__wrapper_8hpp_html_a546a3df1472df59c883c923d5f59663a"><div class="ttname"><a href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a></div><div class="ttdeci">#define _AT_</div><div class="ttdef"><b>Definition:</b> <a href="program__options__wrapper_8hpp_source.html#l00031">program_options_wrapper.hpp:31</a></div></div>
<div class="ttc" id="classutilities_1_1Cout_html_a6219e39487852117bfc3c83dd1b073b1"><div class="ttname"><a href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">utilities::Cout::SecondaryOutput</a></div><div class="ttdeci">std::ostream &amp; SecondaryOutput()</div><div class="ttdef"><b>Definition:</b> <a href="cout__tools_8hpp_source.html#l00125">cout_tools.hpp:125</a></div></div>
<div class="ttc" id="classutilities_1_1SqliteVariable_html_aa8c430dbba489361143ef27983c91313"><div class="ttname"><a href="classutilities_1_1SqliteVariable.html#aa8c430dbba489361143ef27983c91313">utilities::SqliteVariable::SetValues</a></div><div class="ttdeci">void SetValues(const std::string name, const T data)</div><div class="ttdef"><b>Definition:</b> <a href="sqlite__wrapper_8hpp_source.html#l00076">sqlite_wrapper.hpp:76</a></div></div>
<div class="ttc" id="namespacesql_html_aceddbcdc663a2214f73b83c6abec9d78a09fa1bb3cb667039740ba5a81250757a"><div class="ttname"><a href="namespacesql.html#aceddbcdc663a2214f73b83c6abec9d78a09fa1bb3cb667039740ba5a81250757a">sql::_READ_EXISTING_</a></div><div class="ttdef"><b>Definition:</b> <a href="sqlite__wrapper_8hpp_source.html#l00050">sqlite_wrapper.hpp:50</a></div></div>
<div class="ttc" id="namespacesql_html_aceddbcdc663a2214f73b83c6abec9d78ac528df961b488096f159cb0243365fec"><div class="ttname"><a href="namespacesql.html#aceddbcdc663a2214f73b83c6abec9d78ac528df961b488096f159cb0243365fec">sql::_EDIT_EXISTING_</a></div><div class="ttdef"><b>Definition:</b> <a href="sqlite__wrapper_8hpp_source.html#l00050">sqlite_wrapper.hpp:50</a></div></div>
<div class="ttc" id="classutilities_1_1SqliteVariable_html"><div class="ttname"><a href="classutilities_1_1SqliteVariable.html">utilities::SqliteVariable</a></div><div class="ttdef"><b>Definition:</b> <a href="sqlite__wrapper_8hpp_source.html#l00056">sqlite_wrapper.hpp:56</a></div></div>
<div class="ttc" id="classutilities_1_1SqliteRow_html_a2886edefb84a5c8d6e971983a312fc1a"><div class="ttname"><a href="classutilities_1_1SqliteRow.html#a2886edefb84a5c8d6e971983a312fc1a">utilities::SqliteRow::GetLength</a></div><div class="ttdeci">unsigned int GetLength() const </div><div class="ttdoc">Return the number of fields included. </div><div class="ttdef"><b>Definition:</b> <a href="sqlite__wrapper_8cpp_source.html#l00269">sqlite_wrapper.cpp:269</a></div></div>
<div class="ttc" id="classutilities_1_1Sqlite_html"><div class="ttname"><a href="classutilities_1_1Sqlite.html">utilities::Sqlite</a></div><div class="ttdoc">A wrapper class for SQLlite functions. </div><div class="ttdef"><b>Definition:</b> <a href="sqlite__wrapper_8hpp_source.html#l00197">sqlite_wrapper.hpp:197</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a0f670cb88d82d9c815e111de5e76ae3e"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">utilities::MpiWrapper::m_id</a></div><div class="ttdeci">int m_id</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8hpp_source.html#l00056">mpi_wrapper.hpp:56</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_ab7c5634cdbed7e4436b54b9ef619f85b"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">utilities::MpiWrapper::Sync</a></div><div class="ttdeci">void Sync(std::string &amp;buffer, int syncNode) const </div><div class="ttdoc">A function to MPI synchronize a string. </div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8cpp_source.html#l00345">mpi_wrapper.cpp:345</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9c7ec6a354346ac4d5a94c14e71aab0e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void diagonalization::NonInteractingOflModelGrid::PlotMagnetization </td>
          <td>(</td>
          <td class="paramtype">boost::program_options::variables_map *&#160;</td>
          <td class="paramname"><em>optionList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structutilities_1_1MpiWrapper.html">utilities::MpiWrapper</a> &amp;&#160;</td>
          <td class="paramname"><em>mpi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make a plot of the magnetization for a given 2D k-space grid. </p>
<p>Note: This function is parallelized </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">optionList</td><td>Command line arguments </td></tr>
    <tr><td class="paramname">mpi</td><td>Instance of the mpi wrapper class </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="noninteracting__ofl__model__grid_8cpp_source.html#l00640">640</a> of file <a class="el" href="noninteracting__ofl__model__grid_8cpp_source.html">noninteracting_ofl_model_grid.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a903fe4ad596cdce91e00004bc21b7e6a">MainOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tGENERATING SINGLE PARTICLE MAGNETIZATION DATA...&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> dimX;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> dimY;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <span class="keywordtype">double</span> offsetX;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <span class="keywordtype">double</span> offsetY;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, dimX, <span class="stringliteral">&quot;x-grid&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, dimY, <span class="stringliteral">&quot;y-grid&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, offsetX, <span class="stringliteral">&quot;x-grid-shift&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, offsetY, <span class="stringliteral">&quot;y-grid-shift&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">Sync</a>(&amp;dimX, 1, 0);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">Sync</a>(&amp;dimY, 1, 0);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">Sync</a>(&amp;offsetX, 1, 0);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">Sync</a>(&amp;offsetY, 1, 0);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        NonInteractingOflModel currentModel(optionList, mpi);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">SecondaryOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tGRID: &quot;</span>&lt;&lt;dimX&lt;&lt;<span class="stringliteral">&quot; x &quot;</span>&lt;&lt;dimY&lt;&lt;std::endl;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">SecondaryOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tG_X CUT-OFF = &quot;</span>&lt;&lt;currentModel.m_xBandCutOff&lt;&lt;std::endl;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">SecondaryOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tG_Y CUT-OFF = &quot;</span>&lt;&lt;currentModel.m_yBandCutOff&lt;&lt;std::endl;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="comment">//  Get magnetization data</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="keywordtype">double</span> dummy;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <span class="keywordtype">double</span> magnetization[dimX*dimY];</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        this-&gt;<a class="code" href="classdiagonalization_1_1NonInteractingOflModelGrid.html#ae77a9b7b45a0a19409a94e74a683daf1">CalculateBandstructure</a>(&amp;dummy, &amp;dummy, dummy, dummy, <span class="keyword">false</span>, magnetization, <span class="keyword">true</span>, </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                                     dimX, dimY, offsetX, offsetY, &amp;currentModel, mpi);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="keywordflow">if</span>(0 == mpi.<a class="code" href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">m_id</a>)   <span class="comment">// FOR THE MASTER NODE</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            std::stringstream dataFileName;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            dataFileName.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            std::string outPath;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, outPath, <span class="stringliteral">&quot;out-path&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            dataFileName &lt;&lt; outPath &lt;&lt; <span class="stringliteral">&quot;/magnetization_map_kx_&quot;</span> &lt;&lt; dimX &lt;&lt; <span class="stringliteral">&quot;_ky_&quot;</span> &lt;&lt; dimY;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            <span class="keywordtype">bool</span> useSql;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, useSql, <span class="stringliteral">&quot;use-sql&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            <a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> sqlId;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, sqlId, <span class="stringliteral">&quot;sql-id&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            <span class="keywordflow">if</span>(useSql)</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            {</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                dataFileName &lt;&lt; <span class="stringliteral">&quot;_id_&quot;</span> &lt;&lt; sqlId;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            }</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            dataFileName &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            std::ofstream f_tmp;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            f_tmp.open(dataFileName.str().c_str(), std::ios::out);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            <span class="keywordtype">double</span>* p_magnetization = magnetization;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            <a class="code" href="classutilities_1_1LatticeVector2D.html">utilities::LatticeVector2D&lt;double&gt;</a> kVector(offsetX,offsetY);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            <a class="code" href="classutilities_1_1LatticeVector2D.html">utilities::LatticeVector2D&lt;double&gt;</a> increment1(<a class="code" href="namespacediagonalization_1_1reciprocalLattice.html#aa61393cdc02028a0375aa5071f06cb86">reciprocalLattice::G1</a>, (<span class="keywordtype">double</span>)1/dimX);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <a class="code" href="classutilities_1_1LatticeVector2D.html">utilities::LatticeVector2D&lt;double&gt;</a> increment2(<a class="code" href="namespacediagonalization_1_1reciprocalLattice.html#a09fc4b1306501141a270fa90bd159fe1">reciprocalLattice::G2</a>, (<span class="keywordtype">double</span>)1/dimY);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            f_tmp&lt;&lt;dimX&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            f_tmp&lt;&lt;dimY&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            f_tmp&lt;&lt;std::setw(15)&lt;&lt;std::left&lt;&lt;<span class="stringliteral">&quot;kx values&quot;</span>&lt;&lt;<span class="stringliteral">&quot;\t&quot;</span>&lt;&lt;std::setw(15)&lt;&lt;std::left&lt;&lt;<span class="stringliteral">&quot;ky values&quot;</span>&lt;&lt;<span class="stringliteral">&quot;\t&quot;</span>&lt;&lt;std::setw(15)&lt;&lt;std::left&lt;&lt;<span class="stringliteral">&quot;magnetization&quot;</span>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> x=0; x&lt;dimX; ++x, kVector-=<a class="code" href="namespacediagonalization_1_1reciprocalLattice.html#a09fc4b1306501141a270fa90bd159fe1">reciprocalLattice::G2</a>, kVector += increment1)</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                <span class="keywordflow">for</span>(<a class="code" href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">iSize_t</a> y=0; y&lt;dimY; ++y, ++p_magnetization, kVector += increment2)</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                {</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                    f_tmp&lt;&lt;std::setw(15)&lt;&lt;std::left&lt;&lt;kVector.GetKx()&lt;&lt;<span class="stringliteral">&quot;\t&quot;</span>&lt;&lt;std::setw(15)&lt;&lt;std::left&lt;&lt;kVector.GetKy()&lt;&lt;<span class="stringliteral">&quot;\t&quot;</span>&lt;&lt;std::setw(15)&lt;&lt;std::left&lt;&lt;*(p_magnetization)&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            }</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            f_tmp.close();</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">SecondaryOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tData output to file &quot;</span>&lt;&lt;dataFileName.str()&lt;&lt;std::endl;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            <span class="keywordtype">bool</span> plotMagnetization;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, plotMagnetization, <span class="stringliteral">&quot;plot-magnetization&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            <span class="keywordflow">if</span>(plotMagnetization)</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            {</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a2d11fc59d54199d37f4627dc645dff93">AdditionalInfo</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tMAKING PLOT...&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                std::string outPath;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                <a class="code" href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">GetOption</a>(optionList, outPath, <span class="stringliteral">&quot;out-path&quot;</span>, <a class="code" href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a>, mpi);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                std::stringstream plotFileName;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                plotFileName.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                plotFileName &lt;&lt; outPath &lt;&lt; <span class="stringliteral">&quot;/magnetization_map_kx_&quot;</span> &lt;&lt; dimX &lt;&lt; <span class="stringliteral">&quot;_ky_&quot;</span> &lt;&lt; dimY &lt;&lt; <span class="stringliteral">&quot;.pdf&quot;</span>;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                std::stringstream pythonScript; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                pythonScript.str();</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                pythonScript&lt;&lt;<span class="stringliteral">&quot;#! //usr//bin//env python&quot;</span>&lt;&lt;_PYTHON_VERSION_&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                <span class="stringliteral">&quot;import matplotlib                              \n&quot;</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                <span class="stringliteral">&quot;import numpy as np                             \n&quot;</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                <span class="stringliteral">&quot;import math                                    \n&quot;</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                <span class="stringliteral">&quot;matplotlib.use(&#39;Agg&#39;)                        \n\n&quot;</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                <span class="stringliteral">&quot;import matplotlib.pyplot as plt              \n\n&quot;</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                <span class="stringliteral">&quot;from mpl_toolkits.mplot3d import Axes3D      \n\n&quot;</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                <span class="stringliteral">&quot;xData = []                                     \n&quot;</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                <span class="stringliteral">&quot;yData = []                                     \n&quot;</span>   </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                <span class="stringliteral">&quot;magnetization = []                           \n\n&quot;</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                <span class="stringliteral">&quot;fin=open(\&quot;&quot;</span>&lt;&lt;dataFileName.str()&lt;&lt;<span class="stringliteral">&quot;\&quot;)       \n\n&quot;</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                <span class="stringliteral">&quot;fin.readline()                                 \n&quot;</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                <span class="stringliteral">&quot;fin.readline()                                 \n&quot;</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                <span class="stringliteral">&quot;fin.readline()                                 \n&quot;</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                <span class="stringliteral">&quot;for line in fin:                               \n&quot;</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                <span class="stringliteral">&quot;    line = line.split()                        \n&quot;</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                <span class="stringliteral">&quot;    xData.append(float(line[0]))               \n&quot;</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                <span class="stringliteral">&quot;    yData.append(float(line[1]))               \n&quot;</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                <span class="stringliteral">&quot;    magnetization.append(float(line[2]))       \n&quot;</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                <span class="stringliteral">&quot;fin.close()                                  \n\n&quot;</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                <span class="stringliteral">&quot;fig = plt.figure()                           \n\n&quot;</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                <span class="stringliteral">&quot;ax = fig.gca(projection=&#39;3d&#39;)                \n\n&quot;</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                <span class="stringliteral">&quot;ax.plot_trisurf(xData,yData,magnetization)     \n&quot;</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                <span class="stringliteral">&quot;plt.savefig(\&quot;&quot;</span>&lt;&lt;plotFileName.str()&lt;&lt;<span class="stringliteral">&quot;\&quot;) \n&quot;</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                <span class="stringliteral">&quot;plt.close() \n&quot;</span>;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                <a class="code" href="classutilities_1_1Script.html">utilities::Script</a> myScript;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                myScript.<a class="code" href="classutilities_1_1Script.html#af021d99ea6176a02e4affcead01fb4d2">SetScript</a>(pythonScript.str());</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                myScript.<a class="code" href="classutilities_1_1Script.html#acdd7c08fa88f29ac9d735f6be90fcab2">Execute</a>();</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a903fe4ad596cdce91e00004bc21b7e6a">MainOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\t...PLOT SUCESSFULLY GENERATED&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                <a class="code" href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a>.<a class="code" href="classutilities_1_1Cout.html#a903fe4ad596cdce91e00004bc21b7e6a">MainOutput</a>()&lt;&lt;<span class="stringliteral">&quot;\n\tFind it at &quot;</span>&lt;&lt;plotFileName.str()&lt;&lt;std::endl;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        }</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    }</div>
<div class="ttc" id="namespacediagonalization_html_ab6352a2fe0c11db386c8f3e4fc09c38d"><div class="ttname"><a href="namespacediagonalization.html#ab6352a2fe0c11db386c8f3e4fc09c38d">diagonalization::iSize_t</a></div><div class="ttdeci">uint32_t iSize_t</div><div class="ttdef"><b>Definition:</b> <a href="orbital__and__state__defs_8hpp_source.html#l00043">orbital_and_state_defs.hpp:43</a></div></div>
<div class="ttc" id="classdiagonalization_1_1NonInteractingOflModelGrid_html_ae77a9b7b45a0a19409a94e74a683daf1"><div class="ttname"><a href="classdiagonalization_1_1NonInteractingOflModelGrid.html#ae77a9b7b45a0a19409a94e74a683daf1">diagonalization::NonInteractingOflModelGrid::CalculateBandstructure</a></div><div class="ttdeci">void CalculateBandstructure(double *lowerBand, double *secondBand, double &amp;bandWidth, double &amp;bandGap, const bool getEnergyData, double *magnetization, const bool getMagnetizationData, const iSize_t dimX, const iSize_t dimY, const double offsetX, const double offsetY, NonInteractingOflModel *ham, utilities::MpiWrapper &amp;mpi)</div><div class="ttdef"><b>Definition:</b> <a href="noninteracting__ofl__model__grid_8cpp_source.html#l00160">noninteracting_ofl_model_grid.cpp:160</a></div></div>
<div class="ttc" id="namespacediagonalization_1_1reciprocalLattice_html_a09fc4b1306501141a270fa90bd159fe1"><div class="ttname"><a href="namespacediagonalization_1_1reciprocalLattice.html#a09fc4b1306501141a270fa90bd159fe1">diagonalization::reciprocalLattice::G2</a></div><div class="ttdeci">static const utilities::LatticeVector2D&lt; double &gt; G2(0.866025403784438646763723170753,-1.5)</div></div>
<div class="ttc" id="classutilities_1_1Script_html_af021d99ea6176a02e4affcead01fb4d2"><div class="ttname"><a href="classutilities_1_1Script.html#af021d99ea6176a02e4affcead01fb4d2">utilities::Script::SetScript</a></div><div class="ttdeci">void SetScript(const std::string newText)</div><div class="ttdef"><b>Definition:</b> <a href="run__script_8hpp_source.html#l00099">run_script.hpp:99</a></div></div>
<div class="ttc" id="classutilities_1_1Script_html_acdd7c08fa88f29ac9d735f6be90fcab2"><div class="ttname"><a href="classutilities_1_1Script.html#acdd7c08fa88f29ac9d735f6be90fcab2">utilities::Script::Execute</a></div><div class="ttdeci">void Execute() const </div><div class="ttdef"><b>Definition:</b> <a href="run__script_8hpp_source.html#l00113">run_script.hpp:113</a></div></div>
<div class="ttc" id="classutilities_1_1Cout_html_a903fe4ad596cdce91e00004bc21b7e6a"><div class="ttname"><a href="classutilities_1_1Cout.html#a903fe4ad596cdce91e00004bc21b7e6a">utilities::Cout::MainOutput</a></div><div class="ttdeci">std::ostream &amp; MainOutput()</div><div class="ttdef"><b>Definition:</b> <a href="cout__tools_8hpp_source.html#l00118">cout_tools.hpp:118</a></div></div>
<div class="ttc" id="namespaceutilities_html_a8bd217ae821e52872836b15f651f5d9f"><div class="ttname"><a href="namespaceutilities.html#a8bd217ae821e52872836b15f651f5d9f">utilities::cout</a></div><div class="ttdeci">Cout cout</div><div class="ttdef"><b>Definition:</b> <a href="optical__flux__lattice__noninteracting__model_8cpp_source.html#l00035">optical_flux_lattice_noninteracting_model.cpp:35</a></div></div>
<div class="ttc" id="namespaceutilities_html_a0a4e0749cf92abf92f2b0290ae0639a6"><div class="ttname"><a href="namespaceutilities.html#a0a4e0749cf92abf92f2b0290ae0639a6">utilities::GetOption</a></div><div class="ttdeci">void GetOption(boost::program_options::variables_map *variables_map, T &amp;variable, const std::string name, const std::string location)</div><div class="ttdef"><b>Definition:</b> <a href="program__options__wrapper_8hpp_source.html#l00043">program_options_wrapper.hpp:43</a></div></div>
<div class="ttc" id="classutilities_1_1Script_html"><div class="ttname"><a href="classutilities_1_1Script.html">utilities::Script</a></div><div class="ttdoc">A class to convert a given string to a text file and execute it as a script. </div><div class="ttdef"><b>Definition:</b> <a href="run__script_8hpp_source.html#l00050">run_script.hpp:50</a></div></div>
<div class="ttc" id="program__options__wrapper_8hpp_html_a546a3df1472df59c883c923d5f59663a"><div class="ttname"><a href="program__options__wrapper_8hpp.html#a546a3df1472df59c883c923d5f59663a">_AT_</a></div><div class="ttdeci">#define _AT_</div><div class="ttdef"><b>Definition:</b> <a href="program__options__wrapper_8hpp_source.html#l00031">program_options_wrapper.hpp:31</a></div></div>
<div class="ttc" id="classutilities_1_1Cout_html_a6219e39487852117bfc3c83dd1b073b1"><div class="ttname"><a href="classutilities_1_1Cout.html#a6219e39487852117bfc3c83dd1b073b1">utilities::Cout::SecondaryOutput</a></div><div class="ttdeci">std::ostream &amp; SecondaryOutput()</div><div class="ttdef"><b>Definition:</b> <a href="cout__tools_8hpp_source.html#l00125">cout_tools.hpp:125</a></div></div>
<div class="ttc" id="classutilities_1_1Cout_html_a2d11fc59d54199d37f4627dc645dff93"><div class="ttname"><a href="classutilities_1_1Cout.html#a2d11fc59d54199d37f4627dc645dff93">utilities::Cout::AdditionalInfo</a></div><div class="ttdeci">std::ostream &amp; AdditionalInfo()</div><div class="ttdef"><b>Definition:</b> <a href="cout__tools_8hpp_source.html#l00132">cout_tools.hpp:132</a></div></div>
<div class="ttc" id="namespacediagonalization_1_1reciprocalLattice_html_aa61393cdc02028a0375aa5071f06cb86"><div class="ttname"><a href="namespacediagonalization_1_1reciprocalLattice.html#aa61393cdc02028a0375aa5071f06cb86">diagonalization::reciprocalLattice::G1</a></div><div class="ttdeci">static const utilities::LatticeVector2D&lt; double &gt; G1(-0.866025403784438646763723170753,-1.5)</div></div>
<div class="ttc" id="classutilities_1_1LatticeVector2D_html"><div class="ttname"><a href="classutilities_1_1LatticeVector2D.html">utilities::LatticeVector2D&lt; double &gt;</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_a0f670cb88d82d9c815e111de5e76ae3e"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#a0f670cb88d82d9c815e111de5e76ae3e">utilities::MpiWrapper::m_id</a></div><div class="ttdeci">int m_id</div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8hpp_source.html#l00056">mpi_wrapper.hpp:56</a></div></div>
<div class="ttc" id="structutilities_1_1MpiWrapper_html_ab7c5634cdbed7e4436b54b9ef619f85b"><div class="ttname"><a href="structutilities_1_1MpiWrapper.html#ab7c5634cdbed7e4436b54b9ef619f85b">utilities::MpiWrapper::Sync</a></div><div class="ttdeci">void Sync(std::string &amp;buffer, int syncNode) const </div><div class="ttdoc">A function to MPI synchronize a string. </div><div class="ttdef"><b>Definition:</b> <a href="mpi__wrapper_8cpp_source.html#l00345">mpi_wrapper.cpp:345</a></div></div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="noninteracting__ofl__model__grid_8hpp_source.html">noninteracting_ofl_model_grid.hpp</a></li>
<li><a class="el" href="noninteracting__ofl__model__grid_8cpp_source.html">noninteracting_ofl_model_grid.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacediagonalization.html">diagonalization</a></li><li class="navelem"><a class="el" href="classdiagonalization_1_1NonInteractingOflModelGrid.html">NonInteractingOflModelGrid</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
